"""SMEFT beta functions"""

import numpy as np
from collections import OrderedDict
from functools import reduce
import operator

I3 = np.identity(3)

C_keys = ['g', 'gp', 'gs', 'Lambda', 'm2', 'Gu', 'Gd', 'Ge', 'Theta', 'Thetap', 'Thetas', 'G', 'Gtilde', 'W', 'Wtilde', 'CurlyPhi', 'CurlyPhiEmptySquare', 'CurlyPhiD', 'CurlyPhiG', 'CurlyPhiB', 'CurlyPhiW', 'CurlyPhiWB', 'CurlyPhiGtilde', 'CurlyPhiBtilde', 'CurlyPhiWtilde', 'CurlyPhiWtildeB', 'uCurlyPhi', 'dCurlyPhi', 'eCurlyPhi', 'eW', 'eB', 'uG', 'uW', 'uB', 'dG', 'dW', 'dB', 'CurlyPhil1', 'CurlyPhil3', 'CurlyPhie', 'CurlyPhiq1', 'CurlyPhiq3', 'CurlyPhiu', 'CurlyPhid', 'CurlyPhiud', 'll', 'qq1', 'qq3', 'lq1', 'lq3', 'ee', 'uu', 'dd', 'eu', 'ed', 'ud1', 'ud8', 'le', 'lu', 'ld', 'qe', 'qu1', 'qd1', 'qu8', 'qd8', 'ledq', 'quqd1', 'quqd8', 'lequ1', 'lequ3', 'duql', 'qque', 'qqql', 'duue']

C_keys_shape = {
   'g': 1,
   'gp': 1,
   'gs': 1,
   'Lambda': 1,
   'm2': 1,
   'Gu': (3, 3),
   'Gd': (3, 3),
   'Ge': (3, 3),
   'Theta': 1,
   'Thetap': 1,
   'Thetas': 1,
   'G': 1,
   'Gtilde': 1,
   'W': 1,
   'Wtilde': 1,
   'CurlyPhi': 1,
   'CurlyPhiEmptySquare': 1,
   'CurlyPhiD': 1,
   'CurlyPhiG': 1,
   'CurlyPhiB': 1,
   'CurlyPhiW': 1,
   'CurlyPhiWB': 1,
   'CurlyPhiGtilde': 1,
   'CurlyPhiBtilde': 1,
   'CurlyPhiWtilde': 1,
   'CurlyPhiWtildeB': 1,
   'uCurlyPhi': (3,3),
   'dCurlyPhi': (3,3),
   'eCurlyPhi': (3,3),
   'eW': (3,3),
   'eB': (3,3),
   'uG': (3,3),
   'uW': (3,3),
   'uB': (3,3),
   'dG': (3,3),
   'dW': (3,3),
   'dB': (3,3),
   'CurlyPhil1': (3,3),
   'CurlyPhil3': (3,3),
   'CurlyPhie': (3,3),
   'CurlyPhiq1': (3,3),
   'CurlyPhiq3': (3,3),
   'CurlyPhiu': (3,3),
   'CurlyPhid': (3,3),
   'CurlyPhiud': (3,3),
   'll': (3,3,3,3),
   'qq1': (3,3,3,3),
   'qq3': (3,3,3,3),
   'lq1': (3,3,3,3),
   'lq3': (3,3,3,3),
   'ee': (3,3,3,3),
   'uu': (3,3,3,3),
   'dd': (3,3,3,3),
   'eu': (3,3,3,3),
   'ed': (3,3,3,3),
   'ud1': (3,3,3,3),
   'ud8': (3,3,3,3),
   'le': (3,3,3,3),
   'lu': (3,3,3,3),
   'ld': (3,3,3,3),
   'qe': (3,3,3,3),
   'qu1': (3,3,3,3),
   'qd1': (3,3,3,3),
   'qu8': (3,3,3,3),
   'qd8': (3,3,3,3),
   'ledq': (3,3,3,3),
   'quqd1': (3,3,3,3),
   'quqd8': (3,3,3,3),
   'lequ1': (3,3,3,3),
   'lequ3': (3,3,3,3),
   'duql': (3,3,3,3),
   'qque': (3,3,3,3),
   'qqql': (3,3,3,3),
   'duue': (3,3,3,3),
}

def beta(C, HIGHSCALE):
    g = C["g"]
    gp = C["gp"]
    gs = C["gs"]
    m2 = C["m2"]
    Lambda = C["Lambda"]
    Gu = C["Gu"]
    Gd = C["Gd"]
    Ge = C["Ge"]

    #Functions previous defined...  #c.c.   # i in eta5
    Eta1 = (3*np.trace(C["uCurlyPhi"] @ Gu.conj().T) + 3*np.trace(C["dCurlyPhi"] @ Gd.conj().T) + np.trace(C["eCurlyPhi"] @ Ge.conj().T) + 3*np.conj(np.trace(C["uCurlyPhi"] @ Gu.conj().T)) + 3*np.conj(np.trace(C["dCurlyPhi"] @ Gd.conj().T)) + np.conj(np.trace(C["eCurlyPhi"] @ Ge.conj().T)))/2
    Eta2 = -6*np.trace(C["CurlyPhiq3"] @ Gu @ Gu.conj().T) - 6*np.trace(C["CurlyPhiq3"] @ Gd @ Gd.conj().T) - 2*np.trace(C["CurlyPhil3"] @ Ge @ Ge.conj().T) + 3*(np.trace(C["CurlyPhiud"] @ Gd.conj().T @ Gu) + np.conj(np.trace(C["CurlyPhiud"] @ Gd.conj().T @ Gu)))
    Eta3 = 3*np.trace(C["CurlyPhiq1"] @ Gd @ Gd.conj().T) - 3*np.trace(C["CurlyPhiq1"] @ Gu @ Gu.conj().T) + 9*np.trace(C["CurlyPhiq3"] @ Gd @ Gd.conj().T) + 9*np.trace(C["CurlyPhiq3"] @ Gu @ Gu.conj().T) + 3*np.trace(C["CurlyPhiu"] @ Gu.conj().T @ Gu) - 3*np.trace(C["CurlyPhid"] @ Gd.conj().T @ Gd) - 3*(np.trace(C["CurlyPhiud"] @ Gd.conj().T @ Gu) + np.conj(np.trace(C["CurlyPhiud"] @ Gd.conj().T @ Gu))) + np.trace(C["CurlyPhil1"] @ Ge @ Ge.conj().T) + 3*np.trace(C["CurlyPhil3"] @ Ge @ Ge.conj().T) - np.trace(C["CurlyPhie"] @ Ge.conj().T @ Ge)
    Eta4 = 12*np.trace(C["CurlyPhiq1"] @ Gd @ Gd.conj().T) - 12*np.trace(C["CurlyPhiq1"] @ Gu @ Gu.conj().T) + 12*np.trace(C["CurlyPhiu"] @ Gu.conj().T @ Gu) - 12*np.trace(C["CurlyPhid"] @ Gd.conj().T @ Gd) + 6*(np.trace(C["CurlyPhiud"] @ Gd.conj().T @ Gu) + np.conj(np.trace(C["CurlyPhiud"] @ Gd.conj().T @ Gu))) + 4*np.trace(C["CurlyPhil1"] @ Ge @ Ge.conj().T) - 4*np.trace(C["CurlyPhie"] @ Ge.conj().T @ Ge)
    Eta5 = 1j*3/2*(np.trace(Gd @ C["dCurlyPhi"].conj().T) - np.conj(np.trace(Gd @ C["dCurlyPhi"].conj().T))) - 1j*3/2*(np.trace(Gu @ C["uCurlyPhi"].conj().T) - np.conj(np.trace(Gu @ C["uCurlyPhi"].conj().T))) + 1j*1/2*(np.trace(Ge @ C["eCurlyPhi"].conj().T) - np.conj(np.trace(Ge @ C["eCurlyPhi"].conj().T)))

    GammaH = np.trace(3*Gu @ Gu.conj().T + 3*Gd @ Gd.conj().T + Ge @ Ge.conj().T)
    Gammaq = 1/2*(Gu @ Gu.conj().T + Gd @ Gd.conj().T)
    Gammau = Gu.conj().T @ Gu
    Gammad = Gd.conj().T @ Gd
    Gammal = 1/2*Ge @ Ge.conj().T
    Gammae = Ge.conj().T @ Ge

    XiB = 2/3*(C["CurlyPhiEmptySquare"] + C["CurlyPhiD"]) + 8/3*( - np.trace(C["CurlyPhil1"]) + np.trace(C["CurlyPhiq1"]) - np.trace(C["CurlyPhie"]) + 2*np.trace(C["CurlyPhiu"]) - np.trace(C["CurlyPhid"]))
    Xie = 2*np.einsum("prst,rs", C["le"], Ge) - 3*np.einsum("ptsr,rs", C["ledq"], Gd) + 3*np.einsum("ptsr,sr", C["lequ1"], np.conj(Gu))
    Xid = 2*(np.einsum("prst,rs", C["qd1"], Gd) + 4/3*np.einsum("prst,rs", C["qd8"], Gd)) - (3*np.einsum("srpt,sr", C["quqd1"], np.conj(Gu)) + 1/2*(np.einsum("prst,sr", C["quqd1"], np.conj(Gu)) + 4/3*np.einsum("prst,sr", C["quqd8"], np.conj(Gu)))) - np.einsum("srtp,sr", np.conj(C["ledq"]), Ge)
    Xiu = 2*(np.einsum("prst,rs", C["qu1"], Gu) + 4/3*np.einsum("prst,rs", C["qu8"], Gu)) - (3*np.einsum("ptsr,sr", C["quqd1"], np.conj(Gd)) + 1/2*(np.einsum("stpr,sr", C["quqd1"], np.conj(Gd)) + 4/3*np.einsum("stpr,sr", C["quqd8"], np.conj(Gd)))) + np.einsum("srpt,sr", C["lequ1"], np.conj(Ge))

    Beta = OrderedDict()

    Beta["g"] = -19/6*g**3 - 8*g*m2/HIGHSCALE**2*C["CurlyPhiW"]

    Beta["gp"] = 41/6*gp**3 - 8*gp*m2/HIGHSCALE**2*C["CurlyPhiB"]

    Beta["gs"] = -7*gs**3 - 8*gs*m2/HIGHSCALE**2*C["CurlyPhiG"]

    Beta["Lambda"] = 12*Lambda**2 + 3/4*gp**4 + 3/2*g**2*gp**2 + 9/4*g**4 - 3*(gp**2 + 3*g**2)*Lambda + 4*Lambda*GammaH - 4*(3*np.trace(Gd @ Gd.conj().T @ Gd @ Gd.conj().T) + 3*np.trace(Gu @ Gu.conj().T @ Gu @ Gu.conj().T) + np.trace(Ge @ Ge.conj().T @ Ge @ Ge.conj().T)) + 4*m2/HIGHSCALE**2*(12*C["CurlyPhi"] + (-16*Lambda + 10/3*g**2)*C["CurlyPhiEmptySquare"] + (6*Lambda + 3/2*(gp**2 - g**2))*C["CurlyPhiD"] + 2*(Eta1 + Eta2) + 9*g**2*C["CurlyPhiW"] + 3*gp**2*C["CurlyPhiB"] + 3*g*gp*C["CurlyPhiWB"] + 4/3*g**2*(np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"])))

    Beta["m2"] = m2*(6*Lambda - 9/2*g**2 - 3/2*gp**2 + 2*GammaH + 4*m2/HIGHSCALE**2*(C["CurlyPhiD"] - 2*C["CurlyPhiEmptySquare"]))

    Beta["Gu"] = 3/2*(Gu @ Gu.conj().T @ Gu - Gd @ Gd.conj().T @ Gu) + (GammaH - 9/4*g**2 - 17/12*gp**2 - 8*gs**2)*Gu + 2*m2/HIGHSCALE**2*(3*C["uCurlyPhi"] + 1/2*(C["CurlyPhiD"] - 2*C["CurlyPhiEmptySquare"])*Gu - C["CurlyPhiq1"].conj().T @ Gu + 3*C["CurlyPhiq3"].conj().T @ Gu + Gu @ C["CurlyPhiu"].conj().T - Gd @ C["CurlyPhiud"].conj().T - 2*(np.einsum("rpts,pt", C["qu1"], Gu) + 4/3*np.einsum("rpts,pt", C["qu8"], Gu)) - np.einsum("ptrs,pt", C["lequ1"], np.conj(Ge)) + 3*np.einsum("rspt,pt", C["quqd1"], np.conj(Gd)) + 1/2*(np.einsum("psrt,pt", C["quqd1"], np.conj(Gd)) + 4/3*np.einsum("psrt,pt", C["quqd8"], np.conj(Gd))))

    Beta["Gd"] = 3/2*(Gd @ Gd.conj().T @ Gd - Gu @ Gu.conj().T @ Gd) + (GammaH - 9/4*g**2 - 5/12*gp**2 - 8*gs**2)*Gd + 2*m2/HIGHSCALE**2*(3*C["dCurlyPhi"] + 1/2*(C["CurlyPhiD"] - 2*C["CurlyPhiEmptySquare"])*Gd + C["CurlyPhiq1"].conj().T @ Gd + 3*C["CurlyPhiq3"].conj().T @ Gd - Gd @ C["CurlyPhid"].conj().T - Gu @ C["CurlyPhiud"] - 2*(np.einsum("rpts,pt", C["qd1"], Gd) + 4/3*np.einsum("rpts,pt", C["qd8"], Gd)) + np.einsum("ptsr,tp", np.conj(C["ledq"]), np.conj(Ge)) + 3*np.einsum("ptrs,pt", C["quqd1"], np.conj(Gu)) + 1/2*(np.einsum("rpts,pt", C["quqd1"], np.conj(Gu)) + 4/3*np.einsum("rpts,pt", C["quqd8"], np.conj(Gu))))

    Beta["Ge"] = 3/2*Ge @ Ge.conj().T @ Ge + (GammaH - 3/4*(3*g**2 + 5*gp**2))*Ge + 2*m2/HIGHSCALE**2*(3*C["eCurlyPhi"] + 1/2*(C["CurlyPhiD"] - 2*C["CurlyPhiEmptySquare"])*Ge + C["CurlyPhil1"].conj().T @ Ge + 3*C["CurlyPhil3"].conj().T @ Ge - Ge @ C["CurlyPhie"].conj().T - 2*np.einsum("rpts,pt", C["le"], Ge) + 3*np.einsum("rspt,tp", C["ledq"], Gd) - 3*np.einsum("rspt,pt", C["lequ1"], np.conj(Gu)))

    Beta["Theta"] = -128*np.pi**2/g**2*m2/HIGHSCALE**2*C["CurlyPhiWtilde"]

    Beta["Thetap"] = -128*np.pi**2/gp**2*m2/HIGHSCALE**2*C["CurlyPhiBtilde"]

    Beta["Thetas"] = -128*np.pi**2/gs**2*m2/HIGHSCALE**2*C["CurlyPhiGtilde"]

    Beta["G"] = 15*gs**2*C["G"]

    Beta["Gtilde"] = 15*gs**2*C["Gtilde"]

    Beta["W"] = 29/2*g**2*C["W"]

    Beta["Wtilde"] = 29/2*g**2*C["Wtilde"]

    #c.c.
    Beta["CurlyPhi"] = -9/2*(3*g**2 + gp**2)*C["CurlyPhi"] + Lambda*(20/3*g**2*C["CurlyPhiEmptySquare"] + 3*(gp**2 - g**2)*C["CurlyPhiD"]) - 3/4*(g**2 + gp**2)**2*C["CurlyPhiD"] + 6*Lambda*(3*g**2*C["CurlyPhiW"] + gp**2*C["CurlyPhiB"] + g*gp*C["CurlyPhiWB"]) - 3*(g**2*gp**2 + 3*g**4)*C["CurlyPhiW"] - 3*(gp**4 + g**2*gp**2)*C["CurlyPhiB"] - 3*(g*gp**3 + g**3*gp)*C["CurlyPhiWB"] + 8/3*Lambda*g**2*(np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"])) + 54*Lambda*C["CurlyPhi"] - 40*Lambda**2*C["CurlyPhiEmptySquare"] + 12*Lambda**2*C["CurlyPhiD"] + 4*Lambda*(Eta1 + Eta2) - 4*(3*np.trace(C["uCurlyPhi"] @ Gu.conj().T @ Gu @ Gu.conj().T) + 3*np.trace(C["dCurlyPhi"] @ Gd.conj().T @ Gd @ Gd.conj().T) + np.trace(C["eCurlyPhi"] @ Ge.conj().T @ Ge @ Ge.conj().T) + 3*np.conj(np.trace(C["uCurlyPhi"] @ Gu.conj().T @ Gu @ Gu.conj().T)) + 3*np.conj(np.trace(C["dCurlyPhi"] @ Gd.conj().T @ Gd @ Gd.conj().T)) + np.conj(np.trace(C["eCurlyPhi"] @ Ge.conj().T @ Ge @ Ge.conj().T))) + 6*GammaH*C["CurlyPhi"]

    Beta["CurlyPhiEmptySquare"] = -(4*g**2 + 4/3*gp**2)*C["CurlyPhiEmptySquare"] + 5/3*gp**2*C["CurlyPhiD"] + 2*g**2*(np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"])) + 2/3*gp**2*(2*np.trace(C["CurlyPhiu"]) - np.trace(C["CurlyPhid"]) - np.trace(C["CurlyPhie"]) + np.trace(C["CurlyPhiq1"]) - np.trace(C["CurlyPhil1"])) + 12*Lambda*C["CurlyPhiEmptySquare"] - 2*Eta3 + 4*GammaH*C["CurlyPhiEmptySquare"]

    Beta["CurlyPhiD"] = 20/3*gp**2*C["CurlyPhiEmptySquare"] + (9/2*g**2 - 5/6*gp**2)*C["CurlyPhiD"] + 8/3*gp**2*(2*np.trace(C["CurlyPhiu"]) - np.trace(C["CurlyPhid"]) - np.trace(C["CurlyPhie"]) + np.trace(C["CurlyPhiq1"]) - np.trace(C["CurlyPhil1"])) + 6*Lambda*C["CurlyPhiD"] - 2*Eta4 + 4*GammaH*C["CurlyPhiD"]

    #c.c.
    Beta["CurlyPhiG"] = (-3/2*gp**2 - 9/2*g**2 - 14*gs**2)*C["CurlyPhiG"] + 6*Lambda*C["CurlyPhiG"] - 2*gs*(np.trace(C["uG"] @ Gu.conj().T) + np.trace(C["dG"] @ Gd.conj().T) + np.conj(np.trace(C["uG"] @ Gu.conj().T)) + np.conj(np.trace(C["dG"] @ Gd.conj().T))) + 2*GammaH*C["CurlyPhiG"]

    #c.c.
    Beta["CurlyPhiB"] = (85/6*gp**2 - 9/2*g**2)*C["CurlyPhiB"] + 3*g*gp*C["CurlyPhiWB"] + 6*Lambda*C["CurlyPhiB"] + gp*( - 5*np.trace(C["uB"] @ Gu.conj().T) + np.trace(C["dB"] @ Gd.conj().T) + 3*np.trace(C["eB"] @ Ge.conj().T) - 5*np.conj(np.trace(C["uB"] @ Gu.conj().T)) + np.conj(np.trace(C["dB"] @ Gd.conj().T)) + 3*np.conj(np.trace(C["eB"] @ Ge.conj().T))) + 2*GammaH*C["CurlyPhiB"]

    #c.c.
    Beta["CurlyPhiW"] = (-3/2*gp**2 - 53/6*g**2)*C["CurlyPhiW"] + g*gp*C["CurlyPhiWB"] - 15*g**3*C["W"] + 6*Lambda*C["CurlyPhiW"] - g*(3*np.trace(C["uW"] @ Gu.conj().T) + 3*np.trace(C["dW"] @ Gd.conj().T) + np.trace(C["eW"] @ Ge.conj().T) + 3*np.conj(np.trace(C["uW"] @ Gu.conj().T)) + 3*np.conj(np.trace(C["dW"] @ Gd.conj().T)) + np.conj(np.trace(C["eW"] @ Ge.conj().T))) + 2*GammaH*C["CurlyPhiW"]

    #c.c.
    Beta["CurlyPhiWB"] = (19/3*gp**2 + 4/3*g**2)*C["CurlyPhiWB"] + 2*g*gp*(C["CurlyPhiB"] + C["CurlyPhiW"]) + 3*g**2*gp*C["W"] + 2*Lambda*C["CurlyPhiWB"] + g*(3*np.trace(C["uB"] @ Gu.conj().T) - 3*np.trace(C["dB"] @ Gd.conj().T) - np.trace(C["eB"] @ Ge.conj().T) + 3*np.conj(np.trace(C["uB"] @ Gu.conj().T)) - 3*np.conj(np.trace(C["dB"] @ Gd.conj().T)) - np.conj(np.trace(C["eB"] @ Ge.conj().T))) + gp*(5*np.trace(C["uW"] @ Gu.conj().T) + np.trace(C["dW"] @ Gd.conj().T) + 3*np.trace(C["eW"] @ Ge.conj().T) + 5*np.conj(np.trace(C["uW"] @ Gu.conj().T)) + np.conj(np.trace(C["dW"] @ Gd.conj().T)) + 3*np.conj(np.trace(C["eW"] @ Ge.conj().T))) + 2*GammaH*C["CurlyPhiWB"]

    #problem with i as I*iCPV
    Beta["CurlyPhiGtilde"] = (-3/2*gp**2 - 9/2*g**2 - 14*gs**2)*C["CurlyPhiGtilde"] + 6*Lambda*C["CurlyPhiGtilde"] + 2j*gs*(np.trace(C["uG"] @ Gu.conj().T) + np.trace(C["dG"] @ Gd.conj().T) - np.conj(np.trace(C["uG"] @ Gu.conj().T)) - np.conj(np.trace(C["dG"] @ Gd.conj().T))) + 2*GammaH*C["CurlyPhiGtilde"]

    #i
    Beta["CurlyPhiBtilde"] = (85/6*gp**2 - 9/2*g**2)*C["CurlyPhiBtilde"] + 3*g*gp*C["CurlyPhiWtildeB"] + 6*Lambda*C["CurlyPhiBtilde"] - 1j*gp*( - 5*np.trace(C["uB"] @ Gu.conj().T) + np.trace(C["dB"] @ Gd.conj().T) + 3*np.trace(C["eB"] @ Ge.conj().T) + 5*np.conj(np.trace(C["uB"] @ Gu.conj().T)) - np.conj(np.trace(C["dB"] @ Gd.conj().T)) - 3*np.conj(np.trace(C["eB"] @ Ge.conj().T))) + 2*GammaH*C["CurlyPhiBtilde"]

    #i
    Beta["CurlyPhiWtilde"] = (-3/2*gp**2 - 53/6*g**2)*C["CurlyPhiWtilde"] + g*gp*C["CurlyPhiWtildeB"] - 15*g**3*C["Wtilde"] + 6*Lambda*C["CurlyPhiWtilde"] + 1j*g*(3*np.trace(C["uW"] @ Gu.conj().T) + 3*np.trace(C["dW"] @ Gd.conj().T) + np.trace(C["eW"] @ Ge.conj().T) - 3*np.conj(np.trace(C["uW"] @ Gu.conj().T)) - 3*np.conj(np.trace(C["dW"] @ Gd.conj().T)) - np.conj(np.trace(C["eW"] @ Ge.conj().T))) + 2*GammaH*C["CurlyPhiWtilde"]

    #i
    Beta["CurlyPhiWtildeB"] = (19/3*gp**2 + 4/3*g**2)*C["CurlyPhiWtildeB"] + 2*g*gp*(C["CurlyPhiBtilde"] + C["CurlyPhiWtilde"]) + 3*g**2*gp*C["Wtilde"] + 2*Lambda*C["CurlyPhiWtildeB"] - 1j*g*(3*np.trace(C["uB"] @ Gu.conj().T) - 3*np.trace(C["dB"] @ Gd.conj().T) - np.trace(C["eB"] @ Ge.conj().T) - 3*np.conj(np.trace(C["uB"] @ Gu.conj().T)) + 3*np.conj(np.trace(C["dB"] @ Gd.conj().T)) + np.conj(np.trace(C["eB"] @ Ge.conj().T))) - 1j*gp*(5*np.trace(C["uW"] @ Gu.conj().T) + np.trace(C["dW"] @ Gd.conj().T) + 3*np.trace(C["eW"] @ Ge.conj().T) - 5*np.conj(np.trace(C["uW"] @ Gu.conj().T)) - np.conj(np.trace(C["dW"] @ Gd.conj().T)) - 3*np.conj(np.trace(C["eW"] @ Ge.conj().T))) + 2*GammaH*C["CurlyPhiWtildeB"]

    #i  #the coefficients of Eta5 is not equal
    Beta["uCurlyPhi"] = (10/3*g**2*C["CurlyPhiEmptySquare"] + 3/2*(gp**2 - g**2)*C["CurlyPhiD"] + 32*gs**2*(C["CurlyPhiG"] + 1j*C["CurlyPhiGtilde"]) + 9*g**2*(C["CurlyPhiW"] + 1j*C["CurlyPhiWtilde"]) + 17/3*gp**2*(C["CurlyPhiB"] + 1j*C["CurlyPhiBtilde"]) - g*gp*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]) + 4/3*g**2*(np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"])))*Gu - (35/12*gp**2 + 27/4*g**2 + 8*gs**2)*C["uCurlyPhi"] - gp*(5*gp**2 - 3*g**2)*C["uB"] + g*(5*gp**2 - 9*g**2)*C["uW"] - (3*g**2 - gp**2)*Gu @ C["CurlyPhiu"] + 3*g**2*Gd @ C["CurlyPhiud"].conj().T + 4*gp**2*C["CurlyPhiq1"] @ Gu - 4*gp**2*C["CurlyPhiq3"] @ Gu - 5*gp*(C["uB"] @ Gu.conj().T @ Gu + Gu @ Gu.conj().T @ C["uB"]) - 3*g*(C["uW"] @ Gu.conj().T @ Gu - Gu @ Gu.conj().T @ C["uW"]) - 16*gs*(C["uG"] @ Gu.conj().T @ Gu + Gu @ Gu.conj().T @ C["uG"]) - 12*g*Gd @ Gd.conj().T @ C["uW"] - 6*g*C["dW"] @ Gd.conj().T @ Gu + Lambda*(12*C["uCurlyPhi"] - 2*C["CurlyPhiq1"] @ Gu + 6*C["CurlyPhiq3"] @ Gu + 2*Gu @ C["CurlyPhiu"] - 2*Gd @ C["CurlyPhiud"].conj().T - 2*C["CurlyPhiEmptySquare"]*Gu + C["CurlyPhiD"]*Gu - 4*np.einsum("rpts,pt", C["qu1"], Gu) - 16/3*np.einsum("rpts,pt", C["qu8"], Gu) - 2*np.einsum("ptrs,pt", C["lequ1"], np.conj(Ge)) + 6*np.einsum("rspt,pt", C["quqd1"], np.conj(Gd)) + np.einsum("psrt,pt", C["quqd1"], np.conj(Gd)) + 4/3*np.einsum("psrt,pt", C["quqd8"], np.conj(Gd))) + 2*(Eta1 + Eta2 - 1j*Eta5)*Gu + (C["CurlyPhiD"] - 6*C["CurlyPhiEmptySquare"])*Gu @ Gu.conj().T @ Gu - 2*C["CurlyPhiq1"] @ Gu @ Gu.conj().T @ Gu + 6*C["CurlyPhiq3"] @ Gd @ Gd.conj().T @ Gu + 2*Gu @ Gu.conj().T @ Gu @ C["CurlyPhiu"] - 2*Gd @ Gd.conj().T @ Gd @ C["CurlyPhiud"].conj().T + 8*(np.einsum("rpts,pt", C["qu1"], Gu @ Gu.conj().T @ Gu) + 4/3*np.einsum("rpts,pt", C["qu8"], Gu @ Gu.conj().T @ Gu)) - 2*(np.einsum("tsrp,pt", C["quqd1"], Gd.conj().T @ Gd @ Gd.conj().T) + 4/3*np.einsum("tsrp,pt", C["quqd8"], Gd.conj().T @ Gd @ Gd.conj().T)) - 12*np.einsum("rstp,pt", C["quqd1"], Gd.conj().T @ Gd @ Gd.conj().T) + 4*np.einsum("tprs,pt", C["lequ1"], Ge @ Ge.conj().T @ Ge) + 4*C["uCurlyPhi"] @ Gu.conj().T @ Gu + 5*Gu @ Gu.conj().T @ C["uCurlyPhi"] - 2*Gd @ C["dCurlyPhi"].conj().T @ Gu - C["dCurlyPhi"] @ Gd.conj().T @ Gu - 2*Gd @ Gd.conj().T @ C["uCurlyPhi"] + 3*GammaH*C["uCurlyPhi"] + Gammaq @ C["uCurlyPhi"] + C["uCurlyPhi"] @ Gammau

    #i  #Eta5
    Beta["dCurlyPhi"] = (10/3*g**2*C["CurlyPhiEmptySquare"] + 3/2*(gp**2 - g**2)*C["CurlyPhiD"] + 32*gs**2*(C["CurlyPhiG"] + 1j*C["CurlyPhiGtilde"]) + 9*g**2*(C["CurlyPhiW"] + 1j*C["CurlyPhiWtilde"]) + 5/3*gp**2*(C["CurlyPhiB"] + 1j*C["CurlyPhiBtilde"]) + g*gp*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]) + 4/3*g**2*(np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"])))*Gd - (23/12*gp**2 + 27/4*g**2 + 8*gs**2)*C["dCurlyPhi"] - gp*(3*g**2 - gp**2)*C["dB"] - g*(9*g**2 - gp**2)*C["dW"] + (3*g**2 + gp**2)*Gd @ C["CurlyPhid"] + 3*g**2*Gu @ C["CurlyPhiud"] - 2*gp**2*C["CurlyPhiq1"] @ Gd - 2*gp**2*C["CurlyPhiq3"] @ Gd + gp*(C["dB"] @ Gd.conj().T @ Gd + Gd @ Gd.conj().T @ C["dB"]) - 3*g*(C["dW"] @ Gd.conj().T @ Gd - Gd @ Gd.conj().T @ C["dW"]) - 16*gs*(C["dG"] @ Gd.conj().T @ Gd + Gd @ Gd.conj().T @ C["dG"]) - 12*g*Gu @ Gu.conj().T @ C["dW"] - 6*g*C["uW"] @ Gu.conj().T @ Gd + Lambda*(12*C["dCurlyPhi"] + 2*C["CurlyPhiq1"] @ Gd + 6*C["CurlyPhiq3"] @ Gd - 2*Gd @ C["CurlyPhid"] - 2*Gu @ C["CurlyPhiud"] - 2*C["CurlyPhiEmptySquare"]*Gd + C["CurlyPhiD"]*Gd - 4*np.einsum("rpts,pt", C["qd1"], Gd) - 16/3*np.einsum("rpts,pt", C["qd8"], Gd) + 2*np.einsum("ptsr,tp", np.conj(C["ledq"]), np.conj(Ge)) + 6*np.einsum("ptrs,pt", C["quqd1"], np.conj(Gu)) + np.einsum("rtps,pt", C["quqd1"], np.conj(Gu)) + 4/3*np.einsum("rtps,pt", C["quqd8"], np.conj(Gu))) + 2*(Eta1 + Eta2 + 1j*Eta5)*Gd + (C["CurlyPhiD"] - 6*C["CurlyPhiEmptySquare"])*Gd @ Gd.conj().T @ Gd + 2*C["CurlyPhiq1"] @ Gd @ Gd.conj().T @ Gd + 6*C["CurlyPhiq3"] @ Gu @ Gu.conj().T @ Gd - 2*Gd @ Gd.conj().T @ Gd @ C["CurlyPhid"] - 2*Gu @ Gu.conj().T @ Gu @ C["CurlyPhiud"] + 8*(np.einsum("rpts,pt", C["qd1"], Gd @ Gd.conj().T @ Gd) + 4/3*np.einsum("rpts,pt", C["qd8"], Gd @ Gd.conj().T @ Gd)) - 2*(np.einsum("rpts,pt", C["quqd1"], Gu.conj().T @ Gu @ Gu.conj().T) + 4/3*np.einsum("rpts,pt", C["quqd8"], Gu.conj().T @ Gu @ Gu.conj().T)) - 12*np.einsum("tprs,pt", C["quqd1"], Gu @ Gu.conj().T @ Gu) - 4*np.einsum("ptsr,pt", np.conj(C["ledq"]), Ge @ Ge.conj().T @ Ge) + 4*C["dCurlyPhi"] @ Gd.conj().T @ Gd + 5*Gd @ Gd.conj().T @ C["dCurlyPhi"] - 2*Gu @ C["uCurlyPhi"].conj().T @ Gd - C["uCurlyPhi"] @ Gu.conj().T @ Gd - 2*Gu @ Gu.conj().T @ C["dCurlyPhi"] + 3*GammaH*C["dCurlyPhi"] + Gammaq @ C["dCurlyPhi"] + C["dCurlyPhi"] @ Gammad

    #i
    Beta["eCurlyPhi"] = (10/3*g**2*C["CurlyPhiEmptySquare"] + 3/2*(gp**2 - g**2)*C["CurlyPhiD"] + 9*g**2*(C["CurlyPhiW"] + 1j*C["CurlyPhiWtilde"]) + 15*gp**2*(C["CurlyPhiB"] + 1j*C["CurlyPhiBtilde"]) - 3*g*gp*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]) + 4/3*g**2*(np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"])))*Ge - 3/4*(7*gp**2 + 9*g**2)*C["eCurlyPhi"] - 3*gp*(g**2 - 3*gp**2)*C["eB"] - 9*g*(g**2 - gp**2)*C["eW"] + 3*(g**2 - gp**2)*Ge @ C["CurlyPhie"] - 6*gp**2*C["CurlyPhil1"] @ Ge - 6*gp**2*C["CurlyPhil3"] @ Ge + 9*gp*(C["eB"] @ Ge.conj().T @ Ge + Ge @ Ge.conj().T @ C["eB"]) - 3*g*(C["eW"] @ Ge.conj().T @ Ge - Ge @ Ge.conj().T @ C["eW"]) + Lambda*(12*C["eCurlyPhi"] + 2*C["CurlyPhil1"] @ Ge + 6*C["CurlyPhil3"] @ Ge - 2*Ge @ C["CurlyPhie"] - 2*C["CurlyPhiEmptySquare"]*Ge + C["CurlyPhiD"]*Ge - 4*np.einsum("rpts,pt", C["le"], Ge) + 6*np.einsum("rspt,pt", C["ledq"], Gd) - 6*np.einsum("rspt,pt", C["lequ1"], np.conj(Gu))) + 2*(Eta1 + Eta2 + 1j*Eta5)*Ge + (C["CurlyPhiD"] - 6*C["CurlyPhiEmptySquare"])*Ge @ Ge.conj().T @ Ge + 2*C["CurlyPhil1"] @ Ge @ Ge.conj().T @ Ge - 2*Ge @ Ge.conj().T @ Ge @ C["CurlyPhie"] + 8*np.einsum("rpts,pt", C["le"], Ge @ Ge.conj().T @ Ge) - 12*np.einsum("rspt,tp", C["ledq"], Gd @ Gd.conj().T @ Gd) + 12*np.einsum("rstp,pt", C["lequ1"], Gu.conj().T @ Gu @ Gu.conj().T) + 4*C["eCurlyPhi"] @ Ge.conj().T @ Ge + 5*Ge @ Ge.conj().T @ C["eCurlyPhi"] + 3*GammaH*C["eCurlyPhi"] + Gammal @ C["eCurlyPhi"] + C["eCurlyPhi"] @ Gammae

    #i
    Beta["eW"] = 1/12*(3*gp**2 - 11*g**2)*C["eW"] - 1/2*g*gp*C["eB"] - (g*(C["CurlyPhiW"] + 1j*C["CurlyPhiWtilde"]) - 3/2*gp*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]))*Ge - 6*g*np.einsum("rspt,pt", C["lequ3"], np.conj(Gu)) + C["eW"] @ Ge.conj().T @ Ge + GammaH*C["eW"] + Gammal @ C["eW"] + C["eW"] @ Gammae

    #i
    Beta["eB"] = 1/4*(151/3*gp**2 - 9*g**2)*C["eB"] - 3/2*g*gp*C["eW"] - (3/2*g*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]) - 3*gp*(C["CurlyPhiB"] + 1j*C["CurlyPhiBtilde"]))*Ge + 10*gp*np.einsum("rspt,pt", C["lequ3"], np.conj(Gu)) + C["eB"] @ Ge.conj().T @ Ge + 2*Ge @ Ge.conj().T @ C["eB"] + GammaH*C["eB"] + Gammal @ C["eB"] + C["eB"] @ Gammae

    #i
    Beta["uG"] = -1/36*(81*g**2 + 19*gp**2 + 204*gs**2)*C["uG"] + 6*g*gs*C["uW"] + 10/3*gp*gs*C["uB"] - gs*(4*(C["CurlyPhiG"] + 1j*C["CurlyPhiGtilde"]) + 9*gs*(C["G"] + 1j*C["Gtilde"]))*Gu - gs*(np.einsum("psrt,pt", C["quqd1"], np.conj(Gd)) - 1/6*np.einsum("psrt,pt", C["quqd8"], np.conj(Gd))) + 2*Gu @ Gu.conj().T @ C["uG"] - 2*Gd @ Gd.conj().T @ C["uG"] - C["dG"] @ Gd.conj().T @ Gu + C["uG"] @ Gu.conj().T @ Gu + GammaH*C["uG"] + Gammaq @ C["uG"] + C["uG"] @ Gammau

    #i
    Beta["uW"] = -1/36*(33*g**2 + 19*gp**2 - 96*gs**2)*C["uW"] + 8/3*g*gs*C["uG"] - 1/6*g*gp*C["uB"] - (g*(C["CurlyPhiW"] + 1j*C["CurlyPhiWtilde"]) - 5/6*gp*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]))*Gu + g/4*(np.einsum("psrt,pt", C["quqd1"], np.conj(Gd)) + 4/3*np.einsum("psrt,pt", C["quqd8"], np.conj(Gd))) - 2*g*np.einsum("ptrs,tp", C["lequ3"], np.conj(Ge)) + 2*Gd @ Gd.conj().T @ C["uW"] - C["dW"] @ Gd.conj().T @ Gu + C["uW"] @ Gu.conj().T @ Gu + GammaH*C["uW"] + Gammaq @ C["uW"] + C["uW"] @ Gammau

    #i
    Beta["uB"] = -1/36*(81*g**2 - 313*gp**2 - 96*gs**2)*C["uB"] + 40/9*gp*gs*C["uG"] - 1/2*g*gp*C["uW"] - (-3/2*g*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]) + 5/3*gp*(C["CurlyPhiB"] + 1j*C["CurlyPhiBtilde"]))*Gu + gp/12*(np.einsum("psrt,pt", C["quqd1"], np.conj(Gd)) + 4/3*np.einsum("psrt,pt", C["quqd8"], np.conj(Gd))) - 6*gp*np.einsum("ptrs,tp", C["lequ3"], np.conj(Ge)) + 2*Gu @ Gu.conj().T @ C["uB"] - 2*Gd @ Gd.conj().T @ C["uB"] - C["dB"] @ Gd.conj().T @ Gu + C["uB"] @ Gu.conj().T @ Gu + GammaH*C["uB"] + Gammaq @ C["uB"] + C["uB"] @ Gammau

    #i
    Beta["dG"] = -1/36*(81*g**2 + 31*gp**2 + 204*gs**2)*C["dG"] + 6*g*gs*C["dW"] - 2/3*gp*gs*C["dB"] - gs*(4*(C["CurlyPhiG"] + 1j*C["CurlyPhiGtilde"]) + 9*gs*(C["G"] + 1j*C["Gtilde"]))*Gd - gs*(np.einsum("rtps,pt", C["quqd1"], np.conj(Gu)) - 1/6*np.einsum("rtps,pt", C["quqd8"], np.conj(Gu))) - 2*Gu @ Gu.conj().T @ C["dG"] + 2*Gd @ Gd.conj().T @ C["dG"] - C["uG"] @ Gu.conj().T @ Gd + C["dG"] @ Gd.conj().T @ Gd + GammaH*C["dG"] + Gammaq @ C["dG"] + C["dG"] @ Gammad

    #i
    Beta["dW"] = -1/36*(33*g**2 + 31*gp**2 - 96*gs**2)*C["dW"] + 8/3*g*gs*C["dG"] + 5/6*g*gp*C["dB"] - (g*(C["CurlyPhiW"] + 1j*C["CurlyPhiWtilde"]) - gp/6*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]))*Gd + g/4*(np.einsum("rtps,pt", C["quqd1"], np.conj(Gu)) + 4/3*np.einsum("rtps,pt", C["quqd8"], np.conj(Gu))) + 2*Gu @ Gu.conj().T @ C["dW"] - C["uW"] @ Gu.conj().T @ Gd + C["dW"] @ Gd.conj().T @ Gd + GammaH*C["dW"] + Gammaq @ C["dW"] + C["dW"] @ Gammad

    #i
    Beta["dB"] = -1/36*(81*g**2 - 253*gp**2 - 96*gs**2)*C["dB"] - 8/9*gp*gs*C["dG"] + 5/2*g*gp*C["dW"] - (3/2*g*(C["CurlyPhiWB"] + 1j*C["CurlyPhiWtildeB"]) - gp/3*(C["CurlyPhiB"] + 1j*C["CurlyPhiBtilde"]))*Gd - 5/12*gp*(np.einsum("rtps,pt", C["quqd1"], np.conj(Gu)) + 4/3*np.einsum("rtps,pt", C["quqd8"], np.conj(Gu))) - 2*Gu @ Gu.conj().T @ C["dB"] + 2*Gd @ Gd.conj().T @ C["dB"] - C["uB"] @ Gu.conj().T @ Gd + C["dB"] @ Gd.conj().T @ Gd + GammaH*C["dB"] + Gammaq @ C["dB"] + C["dB"] @ Gammad

    #I3 #coefficient not equal with manual!!!!!!
    Beta["CurlyPhil1"] = -1/4*XiB*gp**2*I3 + 1/3*gp**2*C["CurlyPhil1"] - 2/3*gp**2*(np.einsum("rstt", C["ld"]) + np.einsum("rstt", C["le"]) + 2*np.einsum("rstt", C["ll"]) + np.einsum("rtts", C["ll"]) - np.einsum("rstt", C["lq1"]) - 2*np.einsum("rstt", C["lu"])) - 1/2*(C["CurlyPhiEmptySquare"] + C["CurlyPhiD"])*Ge @ Ge.conj().T - Ge @ C["CurlyPhie"] @ Ge.conj().T + 3/2*(Ge @ Ge.conj().T @ C["CurlyPhil1"] + C["CurlyPhil1"] @ Ge @ Ge.conj().T + 3*Ge @ Ge.conj().T @ C["CurlyPhil3"] + 3*C["CurlyPhil3"] @ Ge @ Ge.conj().T) + 2*np.einsum("rspt,tp", C["le"], Ge.conj().T @ Ge) - 2*(2*np.einsum("rspt,tp", C["ll"], Ge @ Ge.conj().T) + np.einsum("rtps,tp", C["ll"], Ge @ Ge.conj().T)) - 6*np.einsum("rspt,tp", C["lq1"], Gd @ Gd.conj().T) + 6*np.einsum("rspt,tp", C["lq1"], Gu @ Gu.conj().T) - 6*np.einsum("rspt,tp", C["lu"], Gu.conj().T @ Gu) + 6*np.einsum("rspt,tp", C["ld"], Gd.conj().T @ Gd) + 2*GammaH*C["CurlyPhil1"] + Gammal @ C["CurlyPhil1"] + C["CurlyPhil1"] @ Gammal

    #I3 #coefficient
    Beta["CurlyPhil3"] = 2/3*g**2*(1/4*C["CurlyPhiEmptySquare"] + np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"]))*I3 - 17/3*g**2*C["CurlyPhil3"] + 2/3*g**2*np.einsum("rtts", C["ll"]) + 2*g**2*np.einsum("rstt", C["lq3"]) - 1/2*C["CurlyPhiEmptySquare"]*Ge @ Ge.conj().T + 1/2*(3*Ge @ Ge.conj().T @ C["CurlyPhil1"] + 3*C["CurlyPhil1"] @ Ge @ Ge.conj().T + Ge @ Ge.conj().T @ C["CurlyPhil3"] + C["CurlyPhil3"] @ Ge @ Ge.conj().T) - 2*(np.einsum("rtps,tp", C["ll"], Ge @ Ge.conj().T)) - 6*np.einsum("rspt,tp", C["lq3"], Gd @ Gd.conj().T) - 6*np.einsum("rspt,tp", C["lq3"], Gu @ Gu.conj().T) + 2*GammaH*C["CurlyPhil3"] + Gammal @ C["CurlyPhil3"] + C["CurlyPhil3"] @ Gammal

    #I3  #coefficient even terms not equal...
    Beta["CurlyPhie"] = -1/2*XiB*gp**2*I3 + 1/3*gp**2*C["CurlyPhie"] - 2/3*gp**2*(np.einsum("rstt", C["ed"]) + 4*np.einsum("rstt", C["ee"]) - 2*np.einsum("rstt", C["eu"]) + np.einsum("ttrs", C["le"]) - np.einsum("ttrs", C["qe"])) + (C["CurlyPhiEmptySquare"] + C["CurlyPhiD"])*Ge.conj().T @ Ge - 2*Ge.conj().T @ C["CurlyPhil1"] @ Ge + 3*(Ge.conj().T @ Ge @ C["CurlyPhie"] + C["CurlyPhie"] @ Ge.conj().T @ Ge) - 2*np.einsum("ptrs,tp", C["le"], Ge @ Ge.conj().T) + 8*np.einsum("rspt,tp", C["ee"], Ge.conj().T @ Ge) - 6*np.einsum("rspt,tp", C["eu"], Gu.conj().T @ Gu) + 6*np.einsum("rspt,tp", C["ed"], Gd.conj().T @ Gd) - 6*np.einsum("ptrs,tp", C["qe"], Gd @ Gd.conj().T) + 6*np.einsum("ptrs,tp", C["qe"], Gu @ Gu.conj().T) + 2*GammaH*C["CurlyPhie"] + Gammae @ C["CurlyPhie"] + C["CurlyPhie"] @ Gammae

    #I3  #coefficient???
    Beta["CurlyPhiq1"] = 1/12*XiB*gp**2*I3 + 1/3*gp**2*C["CurlyPhiq1"] - 2/3*gp**2*(np.einsum("ttrs", C["lq1"]) + np.einsum("rstt", C["qd1"]) - 2*np.einsum("rstt", C["qu1"]) + np.einsum("rstt", C["qe"]) - 2*np.einsum("rstt", C["qq1"]) - 1/3*np.einsum("rtts", C["qq1"]) - np.einsum("rtts", C["qq3"])) + 1/2*(C["CurlyPhiEmptySquare"] + C["CurlyPhiD"])*(Gu @ Gu.conj().T - Gd @ Gd.conj().T) - Gu @ C["CurlyPhiu"] @ Gu.conj().T - Gd @ C["CurlyPhid"] @ Gd.conj().T + 2*np.einsum("rspt,tp", C["qe"], Ge.conj().T @ Ge) - 2*np.einsum("ptrs,tp", C["lq1"], Ge @ Ge.conj().T) + 3/2*(Gd @ Gd.conj().T @ C["CurlyPhiq1"] + Gu @ Gu.conj().T @ C["CurlyPhiq1"] + C["CurlyPhiq1"] @ Gd @ Gd.conj().T + C["CurlyPhiq1"] @ Gu @ Gu.conj().T + 3*Gd @ Gd.conj().T @ C["CurlyPhiq3"] - 3*Gu @ Gu.conj().T @ C["CurlyPhiq3"] + 3*C["CurlyPhiq3"] @ Gd @ Gd.conj().T - 3*C["CurlyPhiq3"] @ Gu @ Gu.conj().T) - 2*(6*np.einsum("ptrs,tp", C["qq1"], Gd @ Gd.conj().T) + np.einsum("psrt,tp", C["qq1"], Gd @ Gd.conj().T) + 3*np.einsum("psrt,tp", C["qq3"], Gd @ Gd.conj().T) - 6*np.einsum("ptrs,tp", C["qq1"], Gu @ Gu.conj().T) - np.einsum("psrt,tp", C["qq1"], Gu @ Gu.conj().T) - 3*np.einsum("psrt,tp", C["qq3"], Gu @ Gu.conj().T)) - 6*np.einsum("rspt,tp", C["qu1"], Gu.conj().T @ Gu) + 6*np.einsum("rspt,tp", C["qd1"], Gd.conj().T @ Gd) + 2*GammaH*C["CurlyPhiq1"] + Gammaq @ C["CurlyPhiq1"] + C["CurlyPhiq1"] @ Gammaq

    #I3 #co
    Beta["CurlyPhiq3"] = 2/3*g**2*(1/4*C["CurlyPhiEmptySquare"] + np.trace(C["CurlyPhil3"]) + 3*np.trace(C["CurlyPhiq3"]))*I3 - 17/3*g**2*C["CurlyPhiq3"] + 2/3*g**2*(np.einsum("ttrs", C["lq3"]) + np.einsum("rtts", C["qq1"]) + 6*np.einsum("rstt", C["qq3"]) - np.einsum("rtts", C["qq3"])) - 1/2*C["CurlyPhiEmptySquare"]*(Gu @ Gu.conj().T + Gd @ Gd.conj().T) + 1/2*(3*Gd @ Gd.conj().T @ C["CurlyPhiq1"] - 3*Gu @ Gu.conj().T @ C["CurlyPhiq1"] + 3*C["CurlyPhiq1"] @ Gd @ Gd.conj().T - 3*C["CurlyPhiq1"] @ Gu @ Gu.conj().T + Gd @ Gd.conj().T @ C["CurlyPhiq3"] + Gu @ Gu.conj().T @ C["CurlyPhiq3"] + C["CurlyPhiq3"] @ Gd @ Gd.conj().T + C["CurlyPhiq3"] @ Gu @ Gu.conj().T) - 2*(6*np.einsum("rspt,tp", C["qq3"], Gd @ Gd.conj().T) + np.einsum("rtps,tp", C["qq1"], Gd @ Gd.conj().T) - np.einsum("rtps,tp", C["qq3"], Gd @ Gd.conj().T) + 6*np.einsum("rspt,tp", C["qq3"], Gu @ Gu.conj().T) + np.einsum("rtps,tp", C["qq1"], Gu @ Gu.conj().T) - np.einsum("rtps,tp", C["qq3"], Gu @ Gu.conj().T)) - 2*np.einsum("ptrs,tp", C["lq3"], Ge @ Ge.conj().T) + 2*GammaH*C["CurlyPhiq3"] + Gammaq @ C["CurlyPhiq3"] + C["CurlyPhiq3"] @ Gammaq

    #I3 #co
    Beta["CurlyPhiu"] = 1/3*XiB*gp**2*I3 + 1/3*gp**2*C["CurlyPhiu"] - 2/3*gp**2*(np.einsum("ttrs", C["eu"]) + np.einsum("ttrs", C["lu"]) - np.einsum("ttrs", C["qu1"]) + np.einsum("rstt", C["ud1"]) - 4*np.einsum("rstt", C["uu"]) - 4/3*np.einsum("rtts", C["uu"])) - (C["CurlyPhiEmptySquare"] + C["CurlyPhiD"])*Gu.conj().T @ Gu - 2*Gu.conj().T @ C["CurlyPhiq1"] @ Gu + 3*(Gu.conj().T @ Gu @ C["CurlyPhiu"] + C["CurlyPhiu"] @ Gu.conj().T @ Gu) + Gu.conj().T @ Gd @ C["CurlyPhiud"].conj().T + C["CurlyPhiud"] @ Gd.conj().T @ Gu - 4*(3*np.einsum("rspt,tp", C["uu"], Gu.conj().T @ Gu) + np.einsum("rtps,tp", C["uu"], Gu.conj().T @ Gu)) + 2*np.einsum("ptrs,tp", C["eu"], Ge.conj().T @ Ge) - 2*np.einsum("ptrs,tp", C["lu"], Ge @ Ge.conj().T) + 6*np.einsum("rspt,tp", C["ud1"], Gd.conj().T @ Gd) - 6*np.einsum("ptrs,tp", C["qu1"], Gd @ Gd.conj().T) + 6*np.einsum("ptrs,tp", C["qu1"], Gu @ Gu.conj().T) + 2*GammaH*C["CurlyPhiu"] + Gammau @ C["CurlyPhiu"] + C["CurlyPhiu"] @ Gammau

    #I3 #co
    Beta["CurlyPhid"] = -1/6*XiB*gp**2*I3 + 1/3*gp**2*C["CurlyPhid"] - 2/3*gp**2*(2*np.einsum("rstt", C["dd"]) + 2/3*np.einsum("rtts", C["dd"]) + np.einsum("ttrs", C["ed"]) + np.einsum("ttrs", C["ld"]) - np.einsum("ttrs", C["qd1"]) - 2*np.einsum("ttrs", C["ud1"])) + (C["CurlyPhiEmptySquare"] + C["CurlyPhiD"])*Gd.conj().T @ Gd - 2*Gd.conj().T @ C["CurlyPhiq1"] @ Gd + 3*(Gd.conj().T @ Gd @ C["CurlyPhid"] + C["CurlyPhid"] @ Gd.conj().T @ Gd) - Gd.conj().T @ Gu @ C["CurlyPhiud"] - C["CurlyPhiud"].conj().T @ Gu.conj().T @ Gd + 4*(3*np.einsum("rspt,tp", C["dd"], Gd.conj().T @ Gd) + np.einsum("rtps,tp", C["dd"], Gd.conj().T @ Gd)) + 2*np.einsum("ptrs,tp", C["ed"], Ge.conj().T @ Ge) - 2*np.einsum("ptrs,tp", C["ld"], Ge @ Ge.conj().T) - 6*np.einsum("ptrs,tp", C["ud1"], Gu.conj().T @ Gu) - 6*np.einsum("ptrs,tp", C["qd1"], Gd @ Gd.conj().T) + 6*np.einsum("ptrs,tp", C["qd1"], Gu @ Gu.conj().T) + 2*GammaH*C["CurlyPhid"] + Gammad @ C["CurlyPhid"] + C["CurlyPhid"] @ Gammad

        #co
    Beta["CurlyPhiud"] = -3*gp**2*C["CurlyPhiud"] + (2*C["CurlyPhiEmptySquare"] - C["CurlyPhiD"])*Gu.conj().T @ Gd - 2*Gu.conj().T @ Gd @ C["CurlyPhid"] + 2*C["CurlyPhiu"] @ Gu.conj().T @ Gd + 4*(np.einsum("rtps,tp", C["ud1"], Gu.conj().T @ Gd) + 4/3*np.einsum("rtps,tp", C["ud8"], Gu.conj().T @ Gd)) + 2*Gu.conj().T @ Gu @ C["CurlyPhiud"] + 2*C["CurlyPhiud"] @ Gd.conj().T @ Gd + 2*GammaH*C["CurlyPhiud"] + Gammau @ C["CurlyPhiud"] + C["CurlyPhiud"] @ Gammad

    # the einsum function is strong
    Beta["ll"] = -1/6*gp**2*np.einsum("st,pr", C["CurlyPhil1"], I3) - 1/6*g**2*(np.einsum("st,pr", C["CurlyPhil3"], I3) - 2*np.einsum("sr,pt", C["CurlyPhil3"], I3)) + 1/3*gp**2*(2*np.einsum("prww,st", C["ll"], I3) + np.einsum("pwwr,st", C["ll"], I3)) - 1/3*g**2*np.einsum("pwwr,st", C["ll"], I3) + 2/3*g**2*np.einsum("swwr,pt", C["ll"], I3) - 1/3*gp**2*np.einsum("prww,st", C["lq1"], I3) - g**2*np.einsum("prww,st", C["lq3"], I3) + 2*g**2*np.einsum("ptww,rs", C["lq3"], I3) + 1/3*gp**2*( - 2*np.einsum("prww,st", C["lu"], I3) + np.einsum("prww,st", C["ld"], I3) + np.einsum("prww,st", C["le"], I3)) - 1/2*(np.einsum("pr,st", Ge @ Ge.conj().T, C["CurlyPhil1"]) - np.einsum("pr,st", Ge @ Ge.conj().T, C["CurlyPhil3"])) - np.einsum("pt,sr", Ge @ Ge.conj().T, C["CurlyPhil3"]) - 1/2*np.einsum("sv,tw,prvw", Ge, np.conj(Ge), C["le"]) + np.einsum("pv,vrst", Gammal, C["ll"]) + np.einsum("pvst,vr", C["ll"], Gammal) - 1/6*gp**2*np.einsum("pr,st", C["CurlyPhil1"], I3) - 1/6*g**2*(np.einsum("pr,st", C["CurlyPhil3"], I3) - 2*np.einsum("pt,sr", C["CurlyPhil3"], I3)) + 1/3*gp**2*(2*np.einsum("stww,pr", C["ll"], I3) + np.einsum("swwt,pr", C["ll"], I3)) - 1/3*g**2*np.einsum("swwt,pr", C["ll"], I3) + 2/3*g**2*np.einsum("pwwt,sr", C["ll"], I3) - 1/3*gp**2*np.einsum("stww,pr", C["lq1"], I3) - g**2*np.einsum("stww,pr", C["lq3"], I3) + 2*g**2*np.einsum("srww,tp", C["lq3"], I3) + 1/3*gp**2*( - 2*np.einsum("stww,pr", C["lu"], I3) + np.einsum("stww,pr", C["ld"], I3) + np.einsum("stww,pr", C["le"], I3)) - 1/2*(np.einsum("st,pr", Ge @ Ge.conj().T, C["CurlyPhil1"]) - np.einsum("st,pr", Ge @ Ge.conj().T, C["CurlyPhil3"])) - np.einsum("sr,pt", Ge @ Ge.conj().T, C["CurlyPhil3"]) - 1/2*np.einsum("pv,rw,stvw", Ge, np.conj(Ge), C["le"]) + np.einsum("sv,vtpr", Gammal, C["ll"]) + np.einsum("svpr,vt", C["ll"], Gammal) + 6*g**2*np.einsum("ptsr", C["ll"]) + 3*(gp**2 - g**2)*np.einsum("prst", C["ll"])

    Beta["qq1"] = 1/18*gp**2*np.einsum("st,pr", C["CurlyPhiq1"], I3) - 1/9*gp**2*np.einsum("wwst,pr", C["lq1"], I3) + 1/9*gp**2*(2*np.einsum("prww,st", C["qq1"], I3) + 1/3*(np.einsum("pwwr,st", C["qq1"], I3) + 3*np.einsum("pwwr,st", C["qq3"], I3))) + 1/3*gs**2*(np.einsum("swwr,pt", C["qq1"], I3) + 3*np.einsum("swwr,pt", C["qq3"], I3)) - 2/9*gs**2*(np.einsum("pwwr,st", C["qq1"], I3) + 3*np.einsum("pwwr,st", C["qq3"], I3)) + 2/9*gp**2*np.einsum("prww,st", C["qu1"], I3) - 1/9*gp**2*np.einsum("prww,st", C["qd1"], I3) + 1/12*gs**2*(np.einsum("srww,pt", C["qu8"], I3) + np.einsum("srww,pt", C["qd8"], I3)) - 1/18*gs**2*(np.einsum("prww,st", C["qu8"], I3) + np.einsum("prww,st", C["qd8"], I3)) - 1/9*gp**2*np.einsum("prww,st", C["qe"], I3) + 1/2*(np.einsum("pr,st", Gu @ Gu.conj().T, C["CurlyPhiq1"]) - np.einsum("pr,st", Gd @ Gd.conj().T, C["CurlyPhiq1"])) - 1/2*(np.einsum("pv,rw,stvw", Gu, np.conj(Gu), C["qu1"]) - 1/6*np.einsum("pv,rw,stvw", Gu, np.conj(Gu), C["qu8"])) - 1/2*(np.einsum("pv,rw,stvw", Gd, np.conj(Gd), C["qd1"]) - 1/6*np.einsum("pv,rw,stvw", Gd, np.conj(Gd), C["qd8"])) - 1/8*(np.einsum("pv,tw,srvw", Gu, np.conj(Gu), C["qu8"]) + np.einsum("pv,tw,srvw", Gd, np.conj(Gd), C["qd8"])) - 1/8*(np.einsum("tw,rv,pvsw", np.conj(Gd), np.conj(Gu), C["quqd1"]) - 1/6*np.einsum("tw,rv,pvsw", np.conj(Gd), np.conj(Gu), C["quqd8"])) - 1/8*(np.einsum("sw,pv,rvtw", Gd, Gu, np.conj(C["quqd1"])) - 1/6*np.einsum("sw,pv,rvtw", Gd, Gu, np.conj(C["quqd8"]))) + 1/16*(np.einsum("tw,rv,svpw", np.conj(Gd), np.conj(Gu), C["quqd8"]) + np.einsum("sw,pv,tvrw", Gd, Gu, np.conj(C["quqd8"]))) + np.einsum("pv,vrst", Gammaq, C["qq1"]) + np.einsum("pvst,vr", C["qq1"], Gammaq) + 1/18*gp**2*np.einsum("pr,st", C["CurlyPhiq1"], I3) - 1/9*gp**2*np.einsum("wwpr,st", C["lq1"], I3) + 1/9*gp**2*(2*np.einsum("stww,pr", C["qq1"], I3) + 1/3*(np.einsum("swwt,pr", C["qq1"], I3) + 3*np.einsum("swwt,pr", C["qq3"], I3))) + 1/3*gs**2*(np.einsum("pwwt,sr", C["qq1"], I3) + 3*np.einsum("pwwt,sr", C["qq3"], I3)) - 2/9*gs**2*(np.einsum("swwt,pr", C["qq1"], I3) + 3*np.einsum("swwt,pr", C["qq3"], I3)) + 2/9*gp**2*np.einsum("stww,pr", C["qu1"], I3) - 1/9*gp**2*np.einsum("stww,pr", C["qd1"], I3) + 1/12*gs**2*(np.einsum("ptww,sr", C["qu8"], I3) + np.einsum("ptww,sr", C["qd8"], I3)) - 1/18*gs**2*(np.einsum("stww,pr", C["qu8"], I3) + np.einsum("stww,pr", C["qd8"], I3)) - 1/9*gp**2*np.einsum("stww,pr", C["qe"], I3) + 1/2*(np.einsum("st,pr", Gu @ Gu.conj().T, C["CurlyPhiq1"]) - np.einsum("st,pr", Gd @ Gd.conj().T, C["CurlyPhiq1"])) - 1/2*(np.einsum("sv,tw,prvw", Gu, np.conj(Gu), C["qu1"]) - 1/6*np.einsum("sv,tw,prvw", Gu, np.conj(Gu), C["qu8"])) - 1/2*(np.einsum("sv,tw,prvw", Gd, np.conj(Gd), C["qd1"]) - 1/6*np.einsum("sv,tw,prvw", Gd, np.conj(Gd), C["qd8"])) - 1/8*(np.einsum("sv,rw,ptvw", Gu, np.conj(Gu), C["qu8"]) + np.einsum("sv,rw,ptvw", Gd, np.conj(Gd), C["qd8"])) - 1/8*(np.einsum("rw,tv,svpw", np.conj(Gd), np.conj(Gu), C["quqd1"]) - 1/6*np.einsum("rw,tv,svpw", np.conj(Gd), np.conj(Gu), C["quqd8"])) - 1/8*(np.einsum("pw,sv,tvrw", Gd, Gu, np.conj(C["quqd1"])) - 1/6*np.einsum("pw,sv,tvrw", Gd, Gu, np.conj(C["quqd8"]))) + 1/16*(np.einsum("rw,tv,pvsw", np.conj(Gd), np.conj(Gu), C["quqd8"]) + np.einsum("pw,sv,rvtw", Gd, Gu, np.conj(C["quqd8"]))) + np.einsum("sv,vtpr", Gammaq, C["qq1"]) + np.einsum("svpr,vt", C["qq1"], Gammaq) + 9*g**2*np.einsum("prst", C["qq3"]) - 2*(gs**2 - 1/6*gp**2)*np.einsum("prst", C["qq1"]) + 3*gs**2*(np.einsum("ptsr", C["qq1"]) + 3*np.einsum("ptsr", C["qq3"]))

    Beta["qq3"] = 1/6*g**2*np.einsum("st,pr", C["CurlyPhiq3"], I3) + 1/3*g**2*np.einsum("wwst,pr", C["lq3"], I3) + 1/3*g**2*(np.einsum("pwwr,st", C["qq1"], I3) - np.einsum("pwwr,st", C["qq3"], I3)) + 2*g**2*np.einsum("prww,st", C["qq3"], I3) + 1/3*gs**2*(np.einsum("swwr,pt", C["qq1"], I3) + 3*np.einsum("swwr,pt", C["qq3"], I3)) + 1/12*gs**2*(np.einsum("srww,pt", C["qu8"], I3) + np.einsum("srww,pt", C["qd8"], I3)) - 1/2*(np.einsum("pr,st", Gu @ Gu.conj().T, C["CurlyPhiq3"]) + np.einsum("pr,st", Gd @ Gd.conj().T, C["CurlyPhiq3"])) - 1/8*(np.einsum("pv,tw,srvw", Gu, np.conj(Gu), C["qu8"]) + np.einsum("pv,tw,srvw", Gd, np.conj(Gd), C["qd8"])) + 1/8*(np.einsum("tw,rv,pvsw", np.conj(Gd), np.conj(Gu), C["quqd1"]) - 1/6*np.einsum("tw,rv,pvsw", np.conj(Gd), np.conj(Gu), C["quqd8"])) + 1/8*(np.einsum("sw,pv,rvtw", Gd, Gu, np.conj(C["quqd1"])) - 1/6*np.einsum("sw,pv,rvtw", Gd, Gu, np.conj(C["quqd8"]))) - 1/16*(np.einsum("tw,rv,svpw", np.conj(Gd), np.conj(Gu), C["quqd8"]) + np.einsum("sw,pv,tvrw", Gd, Gu, np.conj(C["quqd8"]))) + np.einsum("pv,vrst", Gammaq, C["qq3"]) + np.einsum("pvst,vr", C["qq3"], Gammaq) + 1/6*g**2*np.einsum("pr,st", C["CurlyPhiq3"], I3) + 1/3*g**2*np.einsum("wwpr,st", C["lq3"], I3) + 1/3*g**2*(np.einsum("swwt,pr", C["qq1"], I3) - np.einsum("swwt,pr", C["qq3"], I3)) + 2*g**2*np.einsum("stww,pr", C["qq3"], I3) + 1/3*gs**2*(np.einsum("pwwt,sr", C["qq1"], I3) + 3*np.einsum("pwwt,sr", C["qq3"], I3)) + 1/12*gs**2*(np.einsum("ptww,sr", C["qu8"], I3) + np.einsum("ptww,sr", C["qd8"], I3)) - 1/2*(np.einsum("st,pr", Gu @ Gu.conj().T, C["CurlyPhiq3"]) + np.einsum("st,pr", Gd @ Gd.conj().T, C["CurlyPhiq3"])) - 1/8*(np.einsum("sv,rw,ptvw", Gu, np.conj(Gu), C["qu8"]) + np.einsum("sv,rw,ptvw", Gd, np.conj(Gd), C["qd8"])) + 1/8*(np.einsum("rw,tv,svpw", np.conj(Gd), np.conj(Gu), C["quqd1"]) - 1/6*np.einsum("rw,tv,svpw", np.conj(Gd), np.conj(Gu), C["quqd8"])) + 1/8*(np.einsum("pw,sv,tvrw", Gd, Gu, np.conj(C["quqd1"])) - 1/6*np.einsum("pw,sv,tvrw", Gd, Gu, np.conj(C["quqd8"]))) - 1/16*(np.einsum("rw,tv,pvsw", np.conj(Gd), np.conj(Gu), C["quqd8"]) + np.einsum("pw,sv,rvtw", Gd, Gu, np.conj(C["quqd8"]))) + np.einsum("sv,vtpr", Gammaq, C["qq3"]) + np.einsum("svpr,vt", C["qq3"], Gammaq) + 3*gs**2*(np.einsum("ptsr", C["qq1"]) - np.einsum("ptsr", C["qq3"])) - 2*(gs**2 + 3*g**2 - 1/6*gp**2)*np.einsum("prst", C["qq3"]) + 3*g**2*np.einsum("prst", C["qq1"])

    #the terms are equal, but the order is not. No wonder if you check some differences inside
    Beta["lq1"] = -1/3*gp**2*np.einsum("st,pr", C["CurlyPhiq1"], I3) + 1/9*gp**2*np.einsum("pr,st", C["CurlyPhil1"], I3) - 2/9*gp**2*(2*np.einsum("prww,st", C["ll"], I3) + np.einsum("pwwr,st", C["ll"], I3)) + 2/9*gp**2*np.einsum("prww,st", C["lq1"], I3) + 2/3*gp**2*np.einsum("wwst,pr", C["lq1"], I3) - 2/9*gp**2*(6*np.einsum("stww,pr", C["qq1"], I3) + np.einsum("swwt,pr", C["qq1"], I3) + 3*np.einsum("swwt,pr", C["qq3"], I3)) - 2/3*gp**2*(2*np.einsum("stww,pr", C["qu1"], I3) - np.einsum("stww,pr", C["qd1"], I3) - np.einsum("stww,pr", C["qe"], I3)) + 2/9*gp**2*(2*np.einsum("prww,st", C["lu"], I3) - np.einsum("prww,st", C["ld"], I3) - np.einsum("prww,st", C["le"], I3)) - gp**2*np.einsum("prst", C["lq1"]) + 9*g**2*np.einsum("prst", C["lq3"]) - np.einsum("pr,st", Ge @ Ge.conj().T, C["CurlyPhiq1"]) + np.einsum("st,pr", Gu @ Gu.conj().T, C["CurlyPhil1"]) - np.einsum("st,pr", Gd @ Gd.conj().T, C["CurlyPhil1"]) + 1/4*(np.einsum("tw,rv,pvsw", np.conj(Gu), np.conj(Ge), C["lequ1"]) - 12*np.einsum("tw,rv,pvsw", np.conj(Gu), np.conj(Ge), C["lequ3"]) + np.einsum("sw,pv,rvtw", Gu, Ge, np.conj(C["lequ1"])) - 12*np.einsum("sw,pv,rvtw", Gu, Ge, np.conj(C["lequ3"]))) - np.einsum("sv,tw,prvw", Gu, np.conj(Gu), C["lu"]) - np.einsum("sv,tw,prvw", Gd, np.conj(Gd), C["ld"]) - np.einsum("pv,rw,stvw", Ge, np.conj(Ge), C["qe"]) + 1/4*(np.einsum("sw,rv,pvwt", Gd, np.conj(Ge), C["ledq"]) + np.einsum("pv,tw,rvws", Ge, np.conj(Gd), np.conj(C["ledq"]))) + np.einsum("pv,vrst", Gammal, C["lq1"]) + np.einsum("sv,prvt", Gammaq, C["lq1"]) + np.einsum("pvst,vr", C["lq1"], Gammal) + np.einsum("prsv,vt", C["lq1"], Gammaq)

    Beta["lq3"] = 1/3*g**2*(np.einsum("st,pr", C["CurlyPhiq3"], I3) + np.einsum("pr,st", C["CurlyPhil3"], I3)) + 2/3*g**2*(3*np.einsum("prww,st", C["lq3"], I3) + np.einsum("wwst,pr", C["lq3"], I3)) + 2/3*g**2*(6*np.einsum("stww,pr", C["qq3"], I3) + np.einsum("swwt,pr", C["qq1"], I3) - np.einsum("swwt,pr", C["qq3"], I3)) + 2/3*g**2*np.einsum("pwwr,st", C["ll"], I3) + 3*g**2*np.einsum("prst", C["lq1"]) - (6*g**2 + gp**2)*np.einsum("prst", C["lq3"]) - np.einsum("pr,st", Ge @ Ge.conj().T, C["CurlyPhiq3"]) - np.einsum("st,pr", Gu @ Gu.conj().T, C["CurlyPhil3"]) - np.einsum("st,pr", Gd @ Gd.conj().T, C["CurlyPhil3"]) - 1/4*(np.einsum("tw,rv,pvsw", np.conj(Gu), np.conj(Ge), C["lequ1"]) - 12*np.einsum("tw,rv,pvsw", np.conj(Gu), np.conj(Ge), C["lequ3"]) + np.einsum("sw,pv,rvtw", Gu, Ge, np.conj(C["lequ1"])) - 12*np.einsum("sw,pv,rvtw", Gu, Ge, np.conj(C["lequ3"]))) + 1/4*(np.einsum("sw,rv,pvwt", Gd, np.conj(Ge), C["ledq"]) + np.einsum("pv,tw,rvws", Ge, np.conj(Gd), np.conj(C["ledq"]))) + np.einsum("pv,vrst", Gammal, C["lq3"]) + np.einsum("sv,prvt", Gammaq, C["lq3"]) + np.einsum("pvst,vr", C["lq3"], Gammal) + np.einsum("prsv,vt", C["lq3"], Gammaq)

    #order
    Beta["ee"] = -1/3*gp**2*np.einsum("st,pr", C["CurlyPhie"], I3) + 2/3*gp**2*(np.einsum("wwpr,st", C["le"], I3) - np.einsum("wwpr,st", C["qe"], I3) - 2*np.einsum("prww,st", C["eu"], I3) + np.einsum("prww,st", C["ed"], I3) + 4*np.einsum("prww,st", C["ee"], I3)) + np.einsum("pr,st", Ge.conj().T @ Ge, C["CurlyPhie"]) - np.einsum("wr,vp,vwst", Ge, np.conj(Ge), C["le"]) + np.einsum("pv,vrst", Gammae, C["ee"]) + np.einsum("pvst,vr", C["ee"], Gammae) - 1/3*gp**2*np.einsum("pr,st", C["CurlyPhie"], I3) + 2/3*gp**2*(np.einsum("wwst,pr", C["le"], I3) - np.einsum("wwst,pr", C["qe"], I3) - 2*np.einsum("stww,pr", C["eu"], I3) + np.einsum("stww,pr", C["ed"], I3) + 4*np.einsum("wwst,pr", C["ee"], I3)) + np.einsum("st,pr", Ge.conj().T @ Ge, C["CurlyPhie"]) - np.einsum("wt,vs,vwpr", Ge, np.conj(Ge), C["le"]) + np.einsum("sv,vtpr", Gammae, C["ee"]) + np.einsum("svpr,vt", C["ee"], Gammae) + 12*gp**2*np.einsum("prst", C["ee"])

    #order
    Beta["uu"] = 2/9*gp**2*np.einsum("st,pr", C["CurlyPhiu"], I3) - 4/9*gp**2*(np.einsum("wwst,pr", C["eu"], I3) + np.einsum("wwst,pr", C["lu"], I3) - np.einsum("wwst,pr", C["qu1"], I3) - 4*np.einsum("wwst,pr", C["uu"], I3) - 4/3*np.einsum("swwt,pr", C["uu"], I3)) - 1/9*gs**2*(np.einsum("wwst,pr", C["qu8"], I3) - 3*np.einsum("wwsr,pt", C["qu8"], I3)) + 2/3*gs**2*np.einsum("pwwt,rs", C["uu"], I3) - 2/9*gs**2*np.einsum("swwt,pr", C["uu"], I3) - 4/9*gp**2*np.einsum("stww,pr", C["ud1"], I3) - 1/18*gs**2*(np.einsum("stww,pr", C["ud8"], I3) - 3*np.einsum("srww,pt", C["ud8"], I3)) - np.einsum("pr,st", Gu.conj().T @ Gu, C["CurlyPhiu"]) - (np.einsum("wr,vp,vwst", Gu, np.conj(Gu), C["qu1"]) - 1/6*np.einsum("wr,vp,vwst", Gu, np.conj(Gu), C["qu8"])) - 1/2*np.einsum("wr,vs,vwpt", Gu, np.conj(Gu), C["qu8"]) + np.einsum("pv,vrst", Gammau, C["uu"]) + np.einsum("pvst,vr", C["uu"], Gammau) + 2/9*gp**2*np.einsum("pr,st", C["CurlyPhiu"], I3) - 4/9*gp**2*(np.einsum("wwpr,st", C["eu"], I3) + np.einsum("wwpr,st", C["lu"], I3) - np.einsum("wwpr,st", C["qu1"], I3) - 4*np.einsum("wwpr,st", C["uu"], I3) - 4/3*np.einsum("pwwr,st", C["uu"], I3)) - 1/9*gs**2*(np.einsum("wwpr,st", C["qu8"], I3) - 3*np.einsum("wwpt,sr", C["qu8"], I3)) + 2/3*gs**2*np.einsum("swwr,tp", C["uu"], I3) - 2/9*gs**2*np.einsum("pwwr,st", C["uu"], I3) - 4/9*gp**2*np.einsum("prww,st", C["ud1"], I3) - 1/18*gs**2*(np.einsum("prww,st", C["ud8"], I3) - 3*np.einsum("ptww,sr", C["ud8"], I3)) - np.einsum("st,pr", Gu.conj().T @ Gu, C["CurlyPhiu"]) - (np.einsum("wt,vs,vwpr", Gu, np.conj(Gu), C["qu1"]) - 1/6*np.einsum("wt,vs,vwpr", Gu, np.conj(Gu), C["qu8"])) - 1/2*np.einsum("wt,vp,vwsr", Gu, np.conj(Gu), C["qu8"]) + np.einsum("sv,vtpr", Gammau, C["uu"]) + np.einsum("svpr,vt", C["uu"], Gammau) + 2*(8/3*gp**2 - gs**2)*np.einsum("prst", C["uu"]) + 6*gs**2*np.einsum("ptsr", C["uu"])

    #order
    Beta["dd"] = -1/9*gp**2*np.einsum("st,pr", C["CurlyPhid"], I3) + 2/9*gp**2*(np.einsum("wwst,pr", C["ed"], I3) + np.einsum("wwst,pr", C["ld"], I3) - np.einsum("wwst,pr", C["qd1"], I3) + 2*np.einsum("wwst,pr", C["dd"], I3) + 2/3*np.einsum("swwt,pr", C["dd"], I3)) - 1/9*gs**2*(np.einsum("wwst,pr", C["qd8"], I3) - 3*np.einsum("wwsr,pt", C["qd8"], I3)) + 2/3*gs**2*np.einsum("pwwt,rs", C["dd"], I3) - 2/9*gs**2*np.einsum("swwt,pr", C["dd"], I3) - 4/9*gp**2*np.einsum("wwst,pr", C["ud1"], I3) - 1/18*gs**2*(np.einsum("wwst,pr", C["ud8"], I3) - 3*np.einsum("wwsr,pt", C["ud8"], I3)) + np.einsum("pr,st", Gd.conj().T @ Gd, C["CurlyPhid"]) - (np.einsum("wr,vp,vwst", Gd, np.conj(Gd), C["qd1"]) - 1/6*np.einsum("wr,vp,vwst", Gd, np.conj(Gd), C["qd8"])) - 1/2*np.einsum("wr,vs,vwpt", Gd, np.conj(Gd), C["qd8"]) + np.einsum("pv,vrst", Gammad, C["dd"]) + np.einsum("pvst,vr", C["dd"], Gammad) - 1/9*gp**2*np.einsum("pr,st", C["CurlyPhid"], I3) + 2/9*gp**2*(np.einsum("wwpr,st", C["ed"], I3) + np.einsum("wwpr,st", C["ld"], I3) - np.einsum("wwpr,st", C["qd1"], I3) + 2*np.einsum("wwpr,st", C["dd"], I3) + 2/3*np.einsum("pwwr,st", C["dd"], I3)) - 1/9*gs**2*(np.einsum("wwpr,st", C["qd8"], I3) - 3*np.einsum("wwpt,sr", C["qd8"], I3)) + 2/3*gs**2*np.einsum("swwr,tp", C["dd"], I3) - 2/9*gs**2*np.einsum("pwwr,st", C["dd"], I3) - 4/9*gp**2*np.einsum("wwpr,st", C["ud1"], I3) - 1/18*gs**2*(np.einsum("wwpr,st", C["ud8"], I3) - 3*np.einsum("wwpt,sr", C["ud8"], I3)) + np.einsum("st,pr", Gd.conj().T @ Gd, C["CurlyPhid"]) - (np.einsum("wt,vs,vwpr", Gd, np.conj(Gd), C["qd1"]) - 1/6*np.einsum("wt,vs,vwpr", Gd, np.conj(Gd), C["qd8"])) - 1/2*np.einsum("wt,vp,vwsr", Gd, np.conj(Gd), C["qd8"]) + np.einsum("sv,vtpr", Gammad, C["dd"]) + np.einsum("svpr,vt", C["dd"], Gammad) + 2*(2/3*gp**2 - gs**2)*np.einsum("prst", C["dd"]) + 6*gs**2*np.einsum("ptsr", C["dd"])

    Beta["eu"] = -2/3*gp**2*(np.einsum("st,pr", C["CurlyPhiu"], I3) + 2*(np.einsum("wwst,pr", C["qu1"], I3) - np.einsum("wwst,pr", C["lu"], I3) + 4*np.einsum("wwst,pr", C["uu"], I3) - np.einsum("wwst,pr", C["eu"], I3) - np.einsum("stww,pr", C["ud1"], I3)) + 8/3*np.einsum("swwt,pr", C["uu"], I3)) + 4/9*gp**2*(np.einsum("pr,st", C["CurlyPhie"], I3) + 2*(np.einsum("wwpr,st", C["qe"], I3) - np.einsum("wwpr,st", C["le"], I3) - 4*np.einsum("prww,st", C["ee"], I3) + 2*np.einsum("prww,st", C["eu"], I3) - np.einsum("prww,st", C["ed"], I3))) - 8*gp**2*np.einsum("prst", C["eu"]) + 2*np.einsum("pr,st", Ge.conj().T @ Ge, C["CurlyPhiu"]) - 2*np.einsum("st,pr", Gu.conj().T @ Gu, C["CurlyPhie"]) + np.einsum("vp,ws,vrwt", np.conj(Ge), np.conj(Gu), C["lequ1"]) - 12*np.einsum("vp,ws,vrwt", np.conj(Ge), np.conj(Gu), C["lequ3"]) + np.einsum("vr,wt,vpws", Ge, Gu, np.conj(C["lequ1"])) - 12*np.einsum("vr,wt,vpws", Ge, Gu, np.conj(C["lequ3"])) - 2*np.einsum("vp,wr,vwst", np.conj(Ge), Ge, C["lu"]) - 2*np.einsum("vs,wt,vwpr", np.conj(Gu), Gu, C["qe"]) + np.einsum("pv,vrst", Gammae, C["eu"]) + np.einsum("sv,prvt", Gammau, C["eu"]) + np.einsum("pvst,vr", C["eu"], Gammae) + np.einsum("prsv,vt", C["eu"], Gammau)

    Beta["ed"] = -2/3*gp**2*(np.einsum("st,pr", C["CurlyPhid"], I3) + 2*(np.einsum("wwst,pr", C["qd1"], I3) - np.einsum("wwst,pr", C["ld"], I3) - 2*np.einsum("wwst,pr", C["dd"], I3) - np.einsum("wwst,pr", C["ed"], I3) + 2*np.einsum("wwst,pr", C["ud1"], I3)) - 4/3*np.einsum("swwt,pr", C["dd"], I3)) - 2/9*gp**2*(np.einsum("pr,st", C["CurlyPhie"], I3) + 2*(np.einsum("wwpr,st", C["qe"], I3) - np.einsum("wwpr,st", C["le"], I3) - 4*np.einsum("prww,st", C["ee"], I3) - np.einsum("prww,st", C["ed"], I3) + 2*np.einsum("prww,st", C["eu"], I3))) + 4*gp**2*np.einsum("prst", C["ed"]) + 2*np.einsum("pr,st", Ge.conj().T @ Ge, C["CurlyPhid"]) + 2*np.einsum("st,pr", Gd.conj().T @ Gd, C["CurlyPhie"]) - 2*np.einsum("vp,wr,vwst", np.conj(Ge), Ge, C["ld"]) - 2*np.einsum("vs,wt,vwpr", np.conj(Gd), Gd, C["qe"]) + np.einsum("vp,wt,vrsw", np.conj(Ge), Gd, C["ledq"]) + np.einsum("vr,ws,vptw", Ge, np.conj(Gd), np.conj(C["ledq"])) + np.einsum("pv,vrst", Gammae, C["ed"]) + np.einsum("sv,prvt", Gammad, C["ed"]) + np.einsum("pvst,vr", C["ed"], Gammae) + np.einsum("prsv,vt", C["ed"], Gammad)

    #order
    Beta["ud1"] = 4/9*gp**2*(np.einsum("st,pr", C["CurlyPhid"], I3) + 2*(np.einsum("wwst,pr", C["qd1"], I3) - np.einsum("wwst,pr", C["ld"], I3) - 2*np.einsum("wwst,pr", C["dd"], I3) + 2*np.einsum("wwst,pr", C["ud1"], I3) - np.einsum("wwst,pr", C["ed"], I3)) - 4/3*np.einsum("swwt,pr", C["dd"], I3)) - 2/9*gp**2*(np.einsum("pr,st", C["CurlyPhiu"], I3) + 2*(np.einsum("wwpr,st", C["qu1"], I3) - np.einsum("wwpr,st", C["lu"], I3) + 4*np.einsum("wwpr,st", C["uu"], I3) - np.einsum("prww,st", C["ud1"], I3) - np.einsum("wwpr,st", C["eu"], I3)) + 8/3*np.einsum("pwwr,st", C["uu"], I3)) - 8/3*(gp**2*np.einsum("prst", C["ud1"]) - gs**2*np.einsum("prst", C["ud8"])) - 2*np.einsum("pr,st", Gu.conj().T @ Gu, C["CurlyPhid"]) + 2*np.einsum("st,pr", Gd.conj().T @ Gd, C["CurlyPhiu"]) + 2/3*np.einsum("sr,pt", Gd.conj().T @ Gu, C["CurlyPhiud"]) + 2/3*np.einsum("pt,rs", Gu.conj().T @ Gd, np.conj(C["CurlyPhiud"])) + 1/3*(np.einsum("vs,wp,vrwt", np.conj(Gd), np.conj(Gu), C["quqd1"]) + 4/3*np.einsum("vs,wp,vrwt", np.conj(Gd), np.conj(Gu), C["quqd8"]) + np.einsum("vt,wr,vpws", Gd, Gu, np.conj(C["quqd1"])) + 4/3*np.einsum("vt,wr,vpws", Gd, Gu, np.conj(C["quqd8"]))) - np.einsum("ws,vp,vrwt", np.conj(Gd), np.conj(Gu), C["quqd1"]) - np.einsum("wt,vr,vpws", Gd, Gu, np.conj(C["quqd1"])) - 2*np.einsum("vp,wr,vwst", np.conj(Gu), Gu, C["qd1"]) - 2*np.einsum("vs,wt,vwpr", np.conj(Gd), Gd, C["qu1"]) + np.einsum("pv,vrst", Gammau, C["ud1"]) + np.einsum("sv,prvt", Gammad, C["ud1"]) + np.einsum("pvst,vr", C["ud1"], Gammau) + np.einsum("prsv,vt", C["ud1"], Gammad)

    #order
    Beta["ud8"] = 8/3*gs**2*np.einsum("pwwr,st", C["uu"], I3) + 8/3*gs**2*np.einsum("swwt,pr", C["dd"], I3) + 4/3*gs**2*np.einsum("wwpr,st", C["qu8"], I3) + 4/3*gs**2*np.einsum("wwst,pr", C["qd8"], I3) + 2/3*gs**2*np.einsum("prww,st", C["ud8"], I3) + 2/3*gs**2*np.einsum("wwst,pr", C["ud8"], I3) - 4*(2/3*gp**2 + gs**2)*np.einsum("prst", C["ud8"]) + 12*gs**2*np.einsum("prst", C["ud1"]) + 4*np.einsum("sr,pt", Gd.conj().T @ Gu, C["CurlyPhiud"]) + 4*np.einsum("pt,rs", Gu.conj().T @ Gd, np.conj(C["CurlyPhiud"])) + 2*(np.einsum("vs,wp,vrwt", np.conj(Gd), np.conj(Gu), C["quqd1"]) - 1/6*np.einsum("vs,wp,vrwt", np.conj(Gd), np.conj(Gu), C["quqd8"]) + np.einsum("vt,wr,vpws", Gd, Gu, np.conj(C["quqd1"])) - 1/6*np.einsum("vt,wr,vpws", Gd, Gu, np.conj(C["quqd8"]))) - 2*np.einsum("vp,wr,vwst", np.conj(Gu), Gu, C["qd8"]) - 2*np.einsum("vs,wt,vwpr", np.conj(Gd), Gd, C["qu8"]) - (np.einsum("ws,vp,vrwt", np.conj(Gd), np.conj(Gu), C["quqd8"]) + np.einsum("wt,vr,vpws", Gd, Gu, np.conj(C["quqd8"]))) + np.einsum("pv,vrst", Gammau, C["ud8"]) + np.einsum("sv,prvt", Gammad, C["ud8"]) + np.einsum("pvst,vr", C["ud8"], Gammau) + np.einsum("prsv,vt", C["ud8"], Gammad)

    Beta["le"] = -1/3*gp**2*np.einsum("st,pr", C["CurlyPhie"], I3) - 2/3*gp**2*np.einsum("pr,st", C["CurlyPhil1"], I3) + 8/3*gp**2*np.einsum("prww,st", C["ll"], I3) + 4/3*gp**2*np.einsum("pwwr,st", C["ll"], I3) - 4/3*gp**2*np.einsum("prww,st", C["lq1"], I3) - 2/3*gp**2*np.einsum("wwst,pr", C["qe"], I3) + 4/3*gp**2*np.einsum("prww,st", C["le"], I3) + 2/3*gp**2*np.einsum("wwst,pr", C["le"], I3) - 8/3*gp**2*np.einsum("prww,st", C["lu"], I3) + 4/3*gp**2*np.einsum("prww,st", C["ld"], I3) - 4/3*gp**2*np.einsum("stww,pr", C["eu"], I3) + 2/3*gp**2*np.einsum("stww,pr", C["ed"], I3) + 8/3*gp**2*np.einsum("wwst,pr", C["ee"], I3) - 6*gp**2*np.einsum("prst", C["le"]) + np.einsum("rs,pt", np.conj(Ge), Xie) + np.einsum("pt,rs", Ge, np.conj(Xie)) - np.einsum("pr,st", Ge @ Ge.conj().T, C["CurlyPhie"]) + 2*np.einsum("st,pr", Ge.conj().T @ Ge, C["CurlyPhil1"]) - 4*np.einsum("pv,rw,vtsw", Ge, np.conj(Ge), C["ee"]) + np.einsum("pw,vs,vrwt", Ge, np.conj(Ge), C["le"]) - 2*np.einsum("wt,vs,pwvr", Ge, np.conj(Ge), C["ll"]) - 4*np.einsum("wt,vs,prvw", Ge, np.conj(Ge), C["ll"]) + np.einsum("vt,rw,pvsw", Ge, np.conj(Ge), C["le"]) + np.einsum("pv,vrst", Gammal, C["le"]) + np.einsum("sv,prvt", Gammae, C["le"]) + np.einsum("pvst,vr", C["le"], Gammal) + np.einsum("prsv,vt", C["le"], Gammae)

    #order
    Beta["lu"] = -1/3*gp**2*np.einsum("st,pr", C["CurlyPhiu"], I3) + 4/9*gp**2*np.einsum("pr,st", C["CurlyPhil1"], I3) - 16/9*gp**2*np.einsum("prww,st", C["ll"], I3) - 8/9*gp**2*np.einsum("pwwr,st", C["ll"], I3) + 8/9*gp**2*np.einsum("prww,st", C["lq1"], I3) - 2/3*gp**2*np.einsum("wwst,pr", C["qu1"], I3) + 16/9*gp**2*np.einsum("prww,st", C["lu"], I3) + 2/3*gp**2*np.einsum("wwst,pr", C["lu"], I3) - 8/9*gp**2*np.einsum("prww,st", C["ld"], I3) - 8/9*gp**2*np.einsum("prww,st", C["le"], I3) + 2/3*gp**2*np.einsum("stww,pr", C["ud1"], I3) + 2/3*gp**2*np.einsum("wwst,pr", C["eu"], I3) - 8/3*gp**2*np.einsum("stww,pr", C["uu"], I3) - 8/9*gp**2*np.einsum("swwt,pr", C["uu"], I3) + 4*gp**2*np.einsum("prst", C["lu"]) - np.einsum("pr,st", Ge @ Ge.conj().T, C["CurlyPhiu"]) - 2*np.einsum("st,pr", Gu.conj().T @ Gu, C["CurlyPhil1"]) - 1/2*(np.einsum("rv,ws,pvwt", np.conj(Ge), np.conj(Gu), C["lequ1"]) + 12*np.einsum("rv,ws,pvwt", np.conj(Ge), np.conj(Gu), C["lequ3"])) - 1/2*(np.einsum("pv,wt,rvws", Ge, Gu, np.conj(C["lequ1"])) + 12*np.einsum("pv,wt,rvws", Ge, Gu, np.conj(C["lequ3"]))) - 2*np.einsum("vs,wt,prvw", np.conj(Gu), Gu, C["lq1"]) - np.einsum("rw,pv,vwst", np.conj(Ge), Ge, C["eu"]) + np.einsum("pv,vrst", Gammal, C["lu"]) + np.einsum("sv,prvt", Gammau, C["lu"]) + np.einsum("pvst,vr", C["lu"], Gammal) + np.einsum("prsv,vt", C["lu"], Gammau)

    Beta["ld"] = -1/3*gp**2*np.einsum("st,pr", C["CurlyPhid"], I3) - 2/9*gp**2*np.einsum("pr,st", C["CurlyPhil1"], I3) + 8/9*gp**2*np.einsum("prww,st", C["ll"], I3) + 4/9*gp**2*np.einsum("pwwr,st", C["ll"], I3) - 4/9*gp**2*np.einsum("prww,st", C["lq1"], I3) - 2/3*gp**2*np.einsum("wwst,pr", C["qd1"], I3) + 4/9*gp**2*np.einsum("prww,st", C["ld"], I3) + 2/3*gp**2*np.einsum("wwst,pr", C["ld"], I3) - 8/9*gp**2*np.einsum("prww,st", C["lu"], I3) + 4/9*gp**2*np.einsum("prww,st", C["le"], I3) - 4/3*gp**2*np.einsum("wwst,pr", C["ud1"], I3) + 2/3*gp**2*np.einsum("wwst,pr", C["ed"], I3) + 4/3*gp**2*np.einsum("stww,pr", C["dd"], I3) + 4/9*gp**2*np.einsum("swwt,pr", C["dd"], I3) - 2*gp**2*np.einsum("prst", C["ld"]) - np.einsum("pr,st", Ge @ Ge.conj().T, C["CurlyPhid"]) + 2*np.einsum("st,pr", Gd.conj().T @ Gd, C["CurlyPhil1"]) - 1/2*np.einsum("rv,wt,pvsw", np.conj(Ge), Gd, C["ledq"]) - 1/2*np.einsum("pv,ws,rvtw", Ge, np.conj(Gd), np.conj(C["ledq"])) - 2*np.einsum("vs,wt,prvw", np.conj(Gd), Gd, C["lq1"]) - np.einsum("rw,pv,vwst", np.conj(Ge), Ge, C["ed"]) + np.einsum("pv,vrst", Gammal, C["ld"]) + np.einsum("sv,prvt", Gammad, C["ld"]) + np.einsum("pvst,vr", C["ld"], Gammal) + np.einsum("prsv,vt", C["ld"], Gammad)

    Beta["qe"] = 1/9*gp**2*np.einsum("st,pr", C["CurlyPhie"], I3) - 2/3*gp**2*np.einsum("pr,st", C["CurlyPhiq1"], I3) - 8/3*gp**2*np.einsum("prww,st", C["qq1"], I3) - 4/9*gp**2*(np.einsum("pwwr,st", C["qq1"], I3) + 3*np.einsum("pwwr,st", C["qq3"], I3)) + 4/3*gp**2*np.einsum("wwpr,st", C["lq1"], I3) - 2/9*gp**2*np.einsum("wwst,pr", C["le"], I3) + 4/3*gp**2*np.einsum("prww,st", C["qe"], I3) + 2/9*gp**2*np.einsum("wwst,pr", C["qe"], I3) - 8/3*gp**2*np.einsum("prww,st", C["qu1"], I3) + 4/3*gp**2*np.einsum("prww,st", C["qd1"], I3) + 4/9*gp**2*np.einsum("stww,pr", C["eu"], I3) - 2/9*gp**2*np.einsum("stww,pr", C["ed"], I3) - 8/9*gp**2*np.einsum("wwst,pr", C["ee"], I3) + 2*gp**2*np.einsum("prst", C["qe"]) + np.einsum("pr,st", Gu @ Gu.conj().T, C["CurlyPhie"]) - np.einsum("pr,st", Gd @ Gd.conj().T, C["CurlyPhie"]) + 2*np.einsum("st,pr", Ge.conj().T @ Ge, C["CurlyPhiq1"]) - 1/2*np.einsum("pw,vs,vtwr", Gd, np.conj(Ge), C["ledq"]) - 1/2*np.einsum("vt,rw,vswp", Ge, np.conj(Gd), np.conj(C["ledq"])) - 2*np.einsum("vs,wt,vwpr", np.conj(Ge), Ge, C["lq1"]) - 1/2*(np.einsum("rw,vs,vtpw", np.conj(Gu), np.conj(Ge), C["lequ1"]) + 12*np.einsum("rw,vs,vtpw", np.conj(Gu), np.conj(Ge), C["lequ3"])) - 1/2*(np.einsum("pw,vt,vsrw", Gu, Ge, np.conj(C["lequ1"])) + 12*np.einsum("pw,vt,vsrw", Gu, Ge, np.conj(C["lequ3"]))) - np.einsum("rw,pv,stvw", np.conj(Gd), Gd, C["ed"]) - np.einsum("rw,pv,stvw", np.conj(Gu), Gu, C["eu"]) + np.einsum("pv,vrst", Gammaq, C["qe"]) + np.einsum("sv,prvt", Gammae, C["qe"]) + np.einsum("pvst,vr", C["qe"], Gammaq) + np.einsum("prsv,vt", C["qe"], Gammae)

    Beta["qu1"] = 1/9*gp**2*np.einsum("st,pr", C["CurlyPhiu"], I3) + 4/9*gp**2*np.einsum("pr,st", C["CurlyPhiq1"], I3) + 16/9*gp**2*np.einsum("prww,st", C["qq1"], I3) + 8/27*gp**2*(np.einsum("pwwr,st", C["qq1"], I3) + 3*np.einsum("pwwr,st", C["qq3"], I3)) - 8/9*gp**2*np.einsum("wwpr,st", C["lq1"], I3) - 8/9*gp**2*np.einsum("prww,st", C["qe"], I3) - 8/9*gp**2*np.einsum("prww,st", C["qd1"], I3) + 16/9*gp**2*np.einsum("prww,st", C["qu1"], I3) + 2/9*gp**2*np.einsum("wwst,pr", C["qu1"], I3) - 2/9*gp**2*np.einsum("wwst,pr", C["lu"], I3) - 2/9*gp**2*np.einsum("wwst,pr", C["eu"], I3) - 2/9*gp**2*np.einsum("stww,pr", C["ud1"], I3) + 8/9*gp**2*np.einsum("stww,pr", C["uu"], I3) + 8/27*gp**2*np.einsum("swwt,pr", C["uu"], I3) - 4/3*gp**2*np.einsum("prst", C["qu1"]) - 8/3*gs**2*np.einsum("prst", C["qu8"]) + 1/3*np.einsum("rs,pt", np.conj(Gu), Xiu) + 1/3*np.einsum("pt,rs", Gu, np.conj(Xiu)) + np.einsum("pr,st", Gu @ Gu.conj().T, C["CurlyPhiu"]) - np.einsum("pr,st", Gd @ Gd.conj().T, C["CurlyPhiu"]) - 2*np.einsum("st,pr", Gu.conj().T @ Gu, C["CurlyPhiq1"]) + 1/3*(np.einsum("pw,vs,vrwt", Gu, np.conj(Gu), C["qu1"]) + 4/3*np.einsum("pw,vs,vrwt", Gu, np.conj(Gu), C["qu8"])) + 1/3*(np.einsum("vt,rw,pvsw", Gu, np.conj(Gu), C["qu1"]) + 4/3*np.einsum("vt,rw,pvsw", Gu, np.conj(Gu), C["qu8"])) + 1/3*(np.einsum("rw,vs,ptvw", np.conj(Gd), np.conj(Gu), C["quqd1"]) + 4/3*np.einsum("rw,vs,ptvw", np.conj(Gd), np.conj(Gu), C["quqd8"])) + 1/3*(np.einsum("pw,vt,rsvw", Gd, Gu, np.conj(C["quqd1"])) + 4/3*np.einsum("pw,vt,rsvw", Gd, Gu, np.conj(C["quqd8"]))) + 1/2*np.einsum("rw,vs,vtpw", np.conj(Gd), np.conj(Gu), C["quqd1"]) + 1/2*np.einsum("pw,vt,vsrw", Gd, Gu, np.conj(C["quqd1"])) - 2/3*(np.einsum("vt,ws,pvwr", Gu, np.conj(Gu), C["qq1"]) + 3*np.einsum("vt,ws,pvwr", Gu, np.conj(Gu), C["qq3"])) - 4*np.einsum("wt,vs,prvw", Gu, np.conj(Gu), C["qq1"]) - 2/3*np.einsum("pv,rw,vtsw", Gu, np.conj(Gu), C["uu"]) - 2*np.einsum("pv,rw,vwst", Gu, np.conj(Gu), C["uu"]) - np.einsum("pv,rw,stvw", Gd, np.conj(Gd), C["ud1"]) + np.einsum("pv,vrst", Gammaq, C["qu1"]) + np.einsum("sv,prvt", Gammau, C["qu1"]) + np.einsum("pvst,vr", C["qu1"], Gammaq) + np.einsum("prsv,vt", C["qu1"], Gammau)

    Beta["qd1"] = 1/9*gp**2*np.einsum("st,pr", C["CurlyPhid"], I3) - 2/9*gp**2*np.einsum("pr,st", C["CurlyPhiq1"], I3) - 8/9*gp**2*np.einsum("prww,st", C["qq1"], I3) - 4/27*gp**2*(np.einsum("pwwr,st", C["qq1"], I3) + 3*np.einsum("pwwr,st", C["qq3"], I3)) + 4/9*gp**2*np.einsum("wwpr,st", C["lq1"], I3) + 4/9*gp**2*np.einsum("prww,st", C["qe"], I3) - 8/9*gp**2*np.einsum("prww,st", C["qu1"], I3) + 4/9*gp**2*np.einsum("prww,st", C["qd1"], I3) + 2/9*gp**2*np.einsum("wwst,pr", C["qd1"], I3) - 2/9*gp**2*np.einsum("wwst,pr", C["ld"], I3) - 2/9*gp**2*np.einsum("wwst,pr", C["ed"], I3) + 4/9*gp**2*np.einsum("wwst,pr", C["ud1"], I3) - 4/9*gp**2*np.einsum("stww,pr", C["dd"], I3) - 4/27*gp**2*np.einsum("swwt,pr", C["dd"], I3) + 2/3*gp**2*np.einsum("prst", C["qd1"]) - 8/3*gs**2*np.einsum("prst", C["qd8"]) + 1/3*np.einsum("rs,pt", np.conj(Gd), Xid) + 1/3*np.einsum("pt,rs", Gd, np.conj(Xid)) + np.einsum("pr,st", Gu @ Gu.conj().T, C["CurlyPhid"]) - np.einsum("pr,st", Gd @ Gd.conj().T, C["CurlyPhid"]) + 2*np.einsum("st,pr", Gd.conj().T @ Gd, C["CurlyPhiq1"]) + 1/3*(np.einsum("pw,vs,vrwt", Gd, np.conj(Gd), C["qd1"]) + 4/3*np.einsum("pw,vs,vrwt", Gd, np.conj(Gd), C["qd8"])) + 1/3*(np.einsum("vt,rw,pvsw", Gd, np.conj(Gd), C["qd1"]) + 4/3*np.einsum("vt,rw,pvsw", Gd, np.conj(Gd), C["qd8"])) + 1/3*(np.einsum("rw,vs,vwpt", np.conj(Gu), np.conj(Gd), C["quqd1"]) + 4/3*np.einsum("rw,vs,vwpt", np.conj(Gu), np.conj(Gd), C["quqd8"])) + 1/3*(np.einsum("pw,vt,vwrs", Gu, Gd, np.conj(C["quqd1"])) + 4/3*np.einsum("pw,vt,vwrs", Gu, Gd, np.conj(C["quqd8"]))) + 1/2*np.einsum("ws,rv,pvwt", np.conj(Gd), np.conj(Gu), C["quqd1"]) + 1/2*np.einsum("pv,wt,rvws", Gu, Gd, np.conj(C["quqd1"])) - 2/3*(np.einsum("vt,ws,pvwr", Gd, np.conj(Gd), C["qq1"]) + 3*np.einsum("vt,ws,pvwr", Gd, np.conj(Gd), C["qq3"])) - 4*np.einsum("wt,vs,prvw", Gd, np.conj(Gd), C["qq1"]) - 2/3*np.einsum("pv,rw,vtsw", Gd, np.conj(Gd), C["dd"]) - 2*np.einsum("pv,rw,vwst", Gd, np.conj(Gd), C["dd"]) - np.einsum("pv,rw,vwst", Gu, np.conj(Gu), C["ud1"]) + np.einsum("pv,vrst", Gammaq, C["qd1"]) + np.einsum("sv,prvt", Gammad, C["qd1"]) + np.einsum("pvst,vr", C["qd1"], Gammaq) + np.einsum("prsv,vt", C["qd1"], Gammad)

    Beta["qu8"] = 8/3*gs**2*(np.einsum("pwwr,st", C["qq1"], I3) + 3*np.einsum("pwwr,st", C["qq3"], I3)) + 2/3*gs**2*np.einsum("prww,st", C["qu8"], I3) + 2/3*gs**2*np.einsum("prww,st", C["qd8"], I3) + 4/3*gs**2*np.einsum("wwst,pr", C["qu8"], I3) + 2/3*gs**2*np.einsum("stww,pr", C["ud8"], I3) + 8/3*gs**2*np.einsum("swwt,pr", C["uu"], I3) - (4/3*gp**2 + 14*gs**2)*np.einsum("prst", C["qu8"]) - 12*gs**2*np.einsum("prst", C["qu1"]) + 2*np.einsum("rs,pt", np.conj(Gu), Xiu) + 2*np.einsum("pt,rs", Gu, np.conj(Xiu)) + 2*(np.einsum("pw,vs,vrwt", Gu, np.conj(Gu), C["qu1"]) - 1/6*np.einsum("pw,vs,vrwt", Gu, np.conj(Gu), C["qu8"])) + 2*(np.einsum("vt,rw,pvsw", Gu, np.conj(Gu), C["qu1"]) - 1/6*np.einsum("vt,rw,pvsw", Gu, np.conj(Gu), C["qu8"])) + 2*(np.einsum("rw,vs,ptvw", np.conj(Gd), np.conj(Gu), C["quqd1"]) - 1/6*np.einsum("rw,vs,ptvw", np.conj(Gd), np.conj(Gu), C["quqd8"])) + 2*(np.einsum("pw,vt,rsvw", Gd, Gu, np.conj(C["quqd1"])) - 1/6*np.einsum("pw,vt,rsvw", Gd, Gu, np.conj(C["quqd8"]))) + 1/2*np.einsum("vs,rw,vtpw", np.conj(Gu), np.conj(Gd), C["quqd8"]) + 1/2*np.einsum("vt,pw,vsrw", Gu, Gd, np.conj(C["quqd8"])) - 4*(np.einsum("vt,ws,pvwr", Gu, np.conj(Gu), C["qq1"]) + 3*np.einsum("vt,ws,pvwr", Gu, np.conj(Gu), C["qq3"])) - 4*np.einsum("pv,rw,vtsw", Gu, np.conj(Gu), C["uu"]) - np.einsum("pv,rw,stvw", Gd, np.conj(Gd), C["ud8"]) + np.einsum("pv,vrst", Gammaq, C["qu8"]) + np.einsum("sv,prvt", Gammau, C["qu8"]) + np.einsum("pvst,vr", C["qu8"], Gammaq) + np.einsum("prsv,vt", C["qu8"], Gammau)

    Beta["qd8"] = 8/3*gs**2*(np.einsum("pwwr,st", C["qq1"], I3) + 3*np.einsum("pwwr,st", C["qq3"], I3)) + 2/3*gs**2*np.einsum("prww,st", C["qu8"], I3) + 2/3*gs**2*np.einsum("prww,st", C["qd8"], I3) + 4/3*gs**2*np.einsum("wwst,pr", C["qd8"], I3) + 2/3*gs**2*np.einsum("wwst,pr", C["ud8"], I3) + 8/3*gs**2*np.einsum("swwt,pr", C["dd"], I3) - (-2/3*gp**2 + 14*gs**2)*np.einsum("prst", C["qd8"]) - 12*gs**2*np.einsum("prst", C["qd1"]) + 2*np.einsum("rs,pt", np.conj(Gd), Xid) + 2*np.einsum("pt,rs", Gd, np.conj(Xid)) + 2*(np.einsum("pw,vs,vrwt", Gd, np.conj(Gd), C["qd1"]) - 1/6*np.einsum("pw,vs,vrwt", Gd, np.conj(Gd), C["qd8"])) + 2*(np.einsum("vt,rw,pvsw", Gd, np.conj(Gd), C["qd1"]) - 1/6*np.einsum("vt,rw,pvsw", Gd, np.conj(Gd), C["qd8"])) + 2*(np.einsum("rw,vs,vwpt", np.conj(Gu), np.conj(Gd), C["quqd1"]) - 1/6*np.einsum("rw,vs,vwpt", np.conj(Gu), np.conj(Gd), C["quqd8"])) + 2*(np.einsum("pw,vt,vwrs", Gu, Gd, np.conj(C["quqd1"])) - 1/6*np.einsum("pw,vt,vwrs", Gu, Gd, np.conj(C["quqd8"]))) + 1/2*np.einsum("vs,rw,pwvt", np.conj(Gd), np.conj(Gu), C["quqd8"]) + 1/2*np.einsum("vt,pw,rwvs", Gd, Gu, np.conj(C["quqd8"])) - 4*(np.einsum("vt,ws,pvwr", Gd, np.conj(Gd), C["qq1"]) + 3*np.einsum("vt,ws,pvwr", Gd, np.conj(Gd), C["qq3"])) - 4*np.einsum("pv,rw,vtsw", Gd, np.conj(Gd), C["dd"]) - np.einsum("pv,rw,vwst", Gu, np.conj(Gu), C["ud8"]) + np.einsum("pv,vrst", Gammaq, C["qd8"]) + np.einsum("sv,prvt", Gammad, C["qd8"]) + np.einsum("pvst,vr", C["qd8"], Gammaq) + np.einsum("prsv,vt", C["qd8"], Gammad)

    Beta["ledq"] = -(8/3*gp**2 + 8*gs**2)*np.einsum("prst", C["ledq"]) - 2*np.einsum("ts,pr", np.conj(Gd), Xie) - 2*np.einsum("rp,st", Ge, np.conj(Xid)) + 2*np.einsum("pv,tw,vrsw", Ge, np.conj(Gd), C["ed"]) - 2*np.einsum("vr,tw,pvsw", Ge, np.conj(Gd), C["ld"]) + 2*np.einsum("vr,ws,pvwt", Ge, np.conj(Gd), C["lq1"]) + 6*np.einsum("vr,ws,pvwt", Ge, np.conj(Gd), C["lq3"]) - 2*np.einsum("pw,vs,vtwr", Ge, np.conj(Gd), C["qe"]) + 2*np.einsum("vs,tw,prvw", np.conj(Gd), np.conj(Gu), C["lequ1"]) + np.einsum("pv,vrst", Gammal, C["ledq"]) + np.einsum("sv,prvt", Gammaq, C["ledq"]) + np.einsum("pvst,vr", C["ledq"], Gammae) + np.einsum("prsv,vt", C["ledq"], Gammad)

    Beta["quqd1"] = 10/3*gp*np.einsum("st,pr", C["dB"], Gu) - 6*g*np.einsum("st,pr", C["dW"], Gu) - 20/9*gp*np.einsum("pt,sr", C["dB"], Gu) + 4*g*np.einsum("pt,sr", C["dW"], Gu) - 64/9*gs*np.einsum("pt,sr", C["dG"], Gu) - 2/3*gp*np.einsum("pr,st", C["uB"], Gd) - 6*g*np.einsum("pr,st", C["uW"], Gd) + 4/9*gp*np.einsum("sr,pt", C["uB"], Gd) + 4*g*np.einsum("sr,pt", C["uW"], Gd) - 64/9*gs*np.einsum("sr,pt", C["uG"], Gd) - 1/2*(11/9*gp**2 + 3*g**2 + 32*gs**2)*np.einsum("prst", C["quqd1"]) - 1/3*( - 5/9*gp**2 - 3*g**2 + 64/3*gs**2)*np.einsum("srpt", C["quqd1"]) - 4/9*( - 5/9*gp**2 - 3*g**2 + 28/3*gs**2)*np.einsum("srpt", C["quqd8"]) + 16/9*gs**2*np.einsum("prst", C["quqd8"]) - 2*np.einsum("pr,st", Gu, Xid) - 2*np.einsum("st,pr", Gd, Xiu) + 4/3*(np.einsum("vr,pw,svwt", Gu, Gd, C["qd1"]) + 4/3*np.einsum("vr,pw,svwt", Gu, Gd, C["qd8"]) + np.einsum("vt,sw,pvwr", Gd, Gu, C["qu1"]) + 4/3*np.einsum("vt,sw,pvwr", Gd, Gu, C["qu8"]) + np.einsum("pw,sv,vrwt", Gd, Gu, C["ud1"]) + 4/3*np.einsum("pw,sv,vrwt", Gd, Gu, C["ud8"])) + 8/3*(np.einsum("wt,vr,svpw", Gd, Gu, C["qq1"]) - 3*np.einsum("wt,vr,svpw", Gd, Gu, C["qq3"]) - 3*np.einsum("wt,vr,swpv", Gd, Gu, C["qq1"]) + 9*np.einsum("wt,vr,swpv", Gd, Gu, C["qq3"])) - 4*np.einsum("sw,pv,vrwt", Gd, Gu, C["ud1"]) + np.einsum("pv,vrst", Gammaq, C["quqd1"]) + np.einsum("sv,prvt", Gammaq, C["quqd1"]) + np.einsum("pvst,vr", C["quqd1"], Gammau) + np.einsum("prsv,vt", C["quqd1"], Gammad)

    Beta["quqd8"] = 8*gs*np.einsum("st,pr", C["dG"], Gu) - 40/3*gp*np.einsum("pt,sr", C["dB"], Gu) + 24*g*np.einsum("pt,sr", C["dW"], Gu) + 16/3*gs*np.einsum("pt,sr", C["dG"], Gu) + 8*gs*np.einsum("pr,st", C["uG"], Gd) + 8/3*gp*np.einsum("sr,pt", C["uB"], Gd) + 24*g*np.einsum("sr,pt", C["uW"], Gd) + 16/3*gs*np.einsum("sr,pt", C["uG"], Gd) + 8*gs**2*np.einsum("prst", C["quqd1"]) + (10/9*gp**2 + 6*g**2 + 16/3*gs**2)*np.einsum("srpt", C["quqd1"]) + (-11/18*gp**2 - 3/2*g**2 + 16/3*gs**2)*np.einsum("prst", C["quqd8"]) - 1/3*(5/9*gp**2 + 3*g**2 + 44/3*gs**2)*np.einsum("srpt", C["quqd8"]) + 8*(np.einsum("vr,pw,svwt", Gu, Gd, C["qd1"]) - 1/6*np.einsum("vr,pw,svwt", Gu, Gd, C["qd8"]) + np.einsum("vt,sw,pvwr", Gd, Gu, C["qu1"]) - 1/6*np.einsum("vt,sw,pvwr", Gd, Gu, C["qu8"]) + np.einsum("pw,sv,vrwt", Gd, Gu, C["ud1"]) - 1/6*np.einsum("pw,sv,vrwt", Gd, Gu, C["ud8"])) + 16*(np.einsum("wt,vr,svpw", Gd, Gu, C["qq1"]) - 3*np.einsum("wt,vr,svpw", Gd, Gu, C["qq3"])) - 4*np.einsum("sw,pv,vrwt", Gd, Gu, C["ud8"]) + np.einsum("pv,vrst", Gammaq, C["quqd8"]) + np.einsum("sv,prvt", Gammaq, C["quqd8"]) + np.einsum("pvst,vr", C["quqd8"], Gammau) + np.einsum("prsv,vt", C["quqd8"], Gammad)

    Beta["lequ1"] = -(11/3*gp**2 + 8*gs**2)*np.einsum("prst", C["lequ1"]) + (30*gp**2 + 18*g**2)*np.einsum("prst", C["lequ3"]) + 2*np.einsum("st,pr", Gu, Xie) + 2*np.einsum("pr,st", Ge, Xiu) + 2*np.einsum("sv,wt,prvw", Gd, Gu, C["ledq"]) + 2*np.einsum("pv,sw,vrwt", Ge, Gu, C["eu"]) + 2*np.einsum("vr,wt,pvsw", Ge, Gu, C["lq1"]) - 6*np.einsum("vr,wt,pvsw", Ge, Gu, C["lq3"]) - 2*np.einsum("vr,sw,pvwt", Ge, Gu, C["lu"]) - 2*np.einsum("pw,vt,svwr", Ge, Gu, C["qe"]) + np.einsum("pv,vrst", Gammal, C["lequ1"]) + np.einsum("sv,prvt", Gammaq, C["lequ1"]) + np.einsum("pvst,vr", C["lequ1"], Gammae) + np.einsum("prsv,vt", C["lequ1"], Gammau)

    Beta["lequ3"] = 5/6*gp*np.einsum("pr,st", C["eB"], Gu) - 3/2*g*np.einsum("st,pr", C["uW"], Ge) - 3/2*gp*np.einsum("st,pr", C["uB"], Ge) - 3/2*g*np.einsum("pr,st", C["eW"], Gu) + (2/9*gp**2 - 3*g**2 + 8/3*gs**2)*np.einsum("prst", C["lequ3"]) + 1/8*(5*gp**2 + 3*g**2)*np.einsum("prst", C["lequ1"]) - 1/2*np.einsum("sw,pv,vrwt", Gu, Ge, C["eu"]) - 1/2*np.einsum("vr,wt,pvsw", Ge, Gu, C["lq1"]) + 3/2*np.einsum("vr,wt,pvsw", Ge, Gu, C["lq3"]) - 1/2*np.einsum("vr,sw,pvwt", Ge, Gu, C["lu"]) - 1/2*np.einsum("pw,vt,svwr", Ge, Gu, C["qe"]) + np.einsum("pv,vrst", Gammal, C["lequ3"]) + np.einsum("sv,prvt", Gammaq, C["lequ3"]) + np.einsum("pvst,vr", C["lequ3"], Gammae) + np.einsum("prsv,vt", C["lequ3"], Gammau)

    Beta["duql"] = -(9/2*g**2 + 11/6*gp**2 + 4*gs**2)*np.einsum("prst", C["duql"]) - np.einsum("sv,wp,vrwt", np.conj(Gd), Gd, C["duql"]) - np.einsum("sv,wr,pvwt", np.conj(Gu), Gu, C["duql"]) + 2*np.einsum("tv,sw,prwv", np.conj(Ge), np.conj(Gu), C["duue"]) + np.einsum("tv,sw,pwrv", np.conj(Ge), np.conj(Gu), C["duue"]) + 4*np.einsum("vp,wr,vwst", Gd, Gu, C["qqql"]) + 4*np.einsum("vp,wr,wvst", Gd, Gu, C["qqql"]) - np.einsum("vp,wr,vswt", Gd, Gu, C["qqql"]) - np.einsum("vp,wr,wsvt", Gd, Gu, C["qqql"]) + 2*np.einsum("wp,tv,wsrv", Gd, np.conj(Ge), C["qque"]) + np.einsum("vp,vrst", Gd.conj().T @ Gd, C["duql"]) + np.einsum("vr,pvst", Gu.conj().T @ Gu, C["duql"]) + 1/2*(np.einsum("vs,prvt", Gu @ Gu.conj().T, C["duql"]) + np.einsum("vs,prvt", Gd @ Gd.conj().T, C["duql"])) + 1/2*np.einsum("vt,prsv", Ge @ Ge.conj().T, C["duql"])

    Beta["qque"] = -(9/2*g**2 + 23/6*gp**2 + 4*gs**2)*np.einsum("prst", C["qque"]) - np.einsum("rv,ws,pwvt", np.conj(Gu), Gu, C["qque"]) + 1/2*np.einsum("wt,rv,vspw", Ge, np.conj(Gd), C["duql"]) - 1/2*(2*np.einsum("pv,rw,vwst", np.conj(Gd), np.conj(Gu), C["duue"]) + np.einsum("pv,rw,vswt", np.conj(Gd), np.conj(Gu), C["duue"])) + 1/2*( - 2*np.einsum("ws,vt,prwv", Gu, Ge, C["qqql"]) + np.einsum("ws,vt,pwrv", Gu, Ge, C["qqql"]) - 2*np.einsum("ws,vt,wprv", Gu, Ge, C["qqql"])) + 1/2*(np.einsum("vp,vrst", Gu @ Gu.conj().T, C["qque"]) + np.einsum("vp,vrst", Gd @ Gd.conj().T, C["qque"])) - np.einsum("pv,ws,rwvt", np.conj(Gu), Gu, C["qque"]) + 1/2*np.einsum("wt,pv,vsrw", Ge, np.conj(Gd), C["duql"]) - 1/2*(2*np.einsum("rv,pw,vwst", np.conj(Gd), np.conj(Gu), C["duue"]) + np.einsum("rv,pw,vswt", np.conj(Gd), np.conj(Gu), C["duue"])) + 1/2*( - 2*np.einsum("ws,vt,rpwv", Gu, Ge, C["qqql"]) + np.einsum("ws,vt,rwpv", Gu, Ge, C["qqql"]) - 2*np.einsum("ws,vt,wrpv", Gu, Ge, C["qqql"])) + 1/2*(np.einsum("vr,vpst", Gu @ Gu.conj().T, C["qque"]) + np.einsum("vr,vpst", Gd @ Gd.conj().T, C["qque"])) + np.einsum("vs,prvt", Gu.conj().T @ Gu, C["qque"]) + np.einsum("vt,prsv", Ge.conj().T @ Ge, C["qque"])

    Beta["qqql"] = -(3*g**2 + 1/3*gp**2 + 4*gs**2)*np.einsum("prst", C["qqql"]) - 4*g**2*(np.einsum("rpst", C["qqql"]) + np.einsum("srpt", C["qqql"]) + np.einsum("psrt", C["qqql"])) - 4*np.einsum("tv,sw,prwv", np.conj(Ge), np.conj(Gu), C["qque"]) + 2*(np.einsum("pv,rw,vwst", np.conj(Gd), np.conj(Gu), C["duql"]) + np.einsum("rv,pw,vwst", np.conj(Gd), np.conj(Gu), C["duql"])) + 1/2*(np.einsum("vp,vrst", Gu @ Gu.conj().T, C["qqql"]) + np.einsum("vp,vrst", Gd @ Gd.conj().T, C["qqql"])) + 1/2*(np.einsum("vr,pvst", Gu @ Gu.conj().T, C["qqql"]) + np.einsum("vr,pvst", Gd @ Gd.conj().T, C["qqql"])) + 1/2*(np.einsum("vs,prvt", Gu @ Gu.conj().T, C["qqql"]) + np.einsum("vs,prvt", Gd @ Gd.conj().T, C["qqql"])) + 1/2*np.einsum("vt,prsv", Ge @ Ge.conj().T, C["qqql"])

    Beta["duue"] = -(2*gp**2 + 4*gs**2)*np.einsum("prst", C["duue"]) - 20/3*gp**2*np.einsum("psrt", C["duue"]) + 4*np.einsum("ws,vt,prwv", Gu, Ge, C["duql"]) - 8*np.einsum("vp,wr,vwst", Gd, Gu, C["qque"]) + np.einsum("vp,vrst", Gd.conj().T @ Gd, C["duue"]) + np.einsum("vr,pvst", Gu.conj().T @ Gu, C["duue"]) + np.einsum("vs,prvt", Gu.conj().T @ Gu, C["duue"]) + np.einsum("vt,prsv", Ge.conj().T @ Ge, C["duue"])

    return Beta

def beta_array(C, HIGHSCALE):
    beta_odict = beta(C, HIGHSCALE)
    return np.hstack([np.asarray(b).ravel() for b in beta_odict.values()])

def C_array2dict(C):
    """Convert a 1D array containing C values to a dictionary."""
    d = OrderedDict()
    i=0
    for k in C_keys:
        s = C_keys_shape[k]
        if s == 1:
            j = i+1
            d[k] = C[i:j]
        else:
            j = i + reduce(operator.mul, s, 1)
            d[k] = C[i:j].reshape(s)
        i = j
    return d

def C_dict2array(C):
    """Convert an OrderedDict containing C values to a 1D array."""
    return np.hstack([np.asarray(C[k]).ravel() for k in C_keys])
